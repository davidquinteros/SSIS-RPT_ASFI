<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="9/9/2024 2:37:27 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="31AS62E322"
  DTS:CreatorName="BG\andres.quinteros"
  DTS:DTSID="{927B4A2B-C1C9-4AC5-8E0F-BD45E03012A7}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.180"
  DTS:LocaleID="16394"
  DTS:ObjectName="001_RPT_Ahorrista"
  DTS:PackageType="5"
  DTS:VersionBuild="58"
  DTS:VersionGUID="{38BAEA8E-DF20-420C-8589-78DDD350B89A}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[ArchivoA]"
      DTS:CreationName="FLATFILE"
      DTS:DTSID="{e101fc7e-ac69-4662-aefe-eff1c3614249}"
      DTS:ObjectName="ArchivoA">
      <DTS:PropertyExpression
        DTS:Name="ConnectionString">@[User::rutaArchivo] +  @[User::nombreArchivoA]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:Format="Delimited"
          DTS:LocaleID="16394"
          DTS:HeaderRowDelimiter="_x007C_"
          DTS:RowDelimiter=""
          DTS:TextQualifier="_x003C_none_x003E_"
          DTS:CodePage="1252"
          DTS:ConnectionString="C:\Users\andres.quinteros\Desktop\Infraestructura de data\Arquitectura de datos\ARQ - ArchivoC Ahorristas - OP-7078\Export\TP20240229A.IBBGA">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="4000"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="FECHACORTE"
              DTS:DTSID="{A22D9CBF-79E4-43EE-9A30-252473706CC4}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="5"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="CODENVIO"
              DTS:DTSID="{43F8CAF8-2219-4EC9-B99B-154C28AEED0E}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="131"
              DTS:DataPrecision="38"
              DTS:DataScale="4"
              DTS:TextQualified="True"
              DTS:ObjectName="MODALIDAD"
              DTS:DTSID="{79D7F17A-124B-4DEE-A070-EB2132DF83F1}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="131"
              DTS:DataPrecision="38"
              DTS:DataScale="4"
              DTS:TextQualified="True"
              DTS:ObjectName="ESTADO"
              DTS:DTSID="{80D9E53D-3530-487F-8808-88D6B6D784BB}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="131"
              DTS:DataPrecision="38"
              DTS:DataScale="4"
              DTS:TextQualified="True"
              DTS:ObjectName="CLASIFICACION_SUMA_SALDOS"
              DTS:DTSID="{C98FF1D2-AE45-4532-B010-66131AAB81B7}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="1"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="RANGO_TASA_PAGADA"
              DTS:DTSID="{576FBB25-36BD-4999-A530-68F0E937C9A0}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="1"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="TIPO_PERSONA"
              DTS:DTSID="{AD81C698-EE5D-4DE6-AA13-3A92099996BB}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="1"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="MONEDA"
              DTS:DTSID="{DC49E5D7-D6D7-4944-90B4-4522A69CC087}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="16"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="SALDO_DEPOSITO"
              DTS:DTSID="{76685DB1-22ED-4638-85F8-5B94AD1D0640}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x000D__x000A_"
              DTS:MaximumWidth="40"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="CANTIDAD_CUENTAS"
              DTS:DTSID="{9E91CD9D-28B2-4E34-B06E-8F8B4FBB9520}"
              DTS:CreationName="" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[ArchivoC]"
      DTS:CreationName="FLATFILE"
      DTS:DTSID="{DCEA2D0F-6917-4E45-802F-1FEA214B300E}"
      DTS:ObjectName="ArchivoC">
      <DTS:PropertyExpression
        DTS:Name="ConnectionString">@[User::rutaCompleta]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:Format="Delimited"
          DTS:LocaleID="16394"
          DTS:HeaderRowDelimiter="_x007C_"
          DTS:RowDelimiter=""
          DTS:TextQualifier="_x003C_none_x003E_"
          DTS:CodePage="1252"
          DTS:ConnectionString="C:\Users\andres.quinteros\Desktop\Infraestructura de data\Arquitectura de datos\ARQ - ArchivoC Ahorristas - OP-7078\Export\TP20240229C.IBBGA">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="10"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="FECHACORTE"
              DTS:DTSID="{9D151355-DD98-442C-85E6-696C3CA1C697}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="5"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="BANCO"
              DTS:DTSID="{F36D2ACF-B1DC-4F81-B7DB-05938D58C1CD}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="131"
              DTS:DataPrecision="38"
              DTS:DataScale="4"
              DTS:TextQualified="True"
              DTS:ObjectName="CODIGOTIPOPERSONA"
              DTS:DTSID="{12ED68FD-C970-4354-AC01-3F52DF543F0C}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="131"
              DTS:DataPrecision="38"
              DTS:DataScale="4"
              DTS:TextQualified="True"
              DTS:ObjectName="NUMERODEPOSITANTESTOTAL"
              DTS:DTSID="{F274082F-1EB9-452C-8A0C-8E978CFC695C}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="40"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="DEPOSITANTESVARONES"
              DTS:DTSID="{22DE8FFE-649E-471E-B12A-3834653FC832}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="40"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="DEPOSITANTESMUJERES"
              DTS:DTSID="{4B0D100D-EE72-4369-A326-378D2BC147D3}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="40"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="NUMEROCUENTAS"
              DTS:DTSID="{B3850E86-681B-4EC3-B793-1733FED32D02}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x000D__x000A_"
              DTS:MaximumWidth="16"
              DTS:DataType="130"
              DTS:TextQualified="True"
              DTS:ObjectName="MONTOSALDO"
              DTS:DTSID="{52A5F05C-FCF4-4D44-AF99-75F208229345}"
              DTS:CreationName="" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{C00E62EB-B927-4ADF-8212-FB38404ACD85}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[$Project::correos]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="correos">
      <DTS:VariableValue
        DTS:DataType="8">adquinteros@bg.com.bo;paulo.salazar@bg.com.bo</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{44B83633-2EA4-4DDD-980E-215946B99C57}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[$Project::fechaFin]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="fechaFin">
      <DTS:VariableValue
        DTS:DataType="8">20240229</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4FE76C33-74AE-4F8B-96C8-C534F0F71D17}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;TP&quot; + @[User::fechaFin] + &quot;A&quot;+&quot;.IBBGA&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="nombreArchivoA">
      <DTS:VariableValue
        DTS:DataType="8">TP20240229A.IBBGA</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{72EDE2EA-C42A-4841-A4DD-6383C8845B70}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;TP&quot; + @[User::fechaFin] + &quot;B&quot;+&quot;.IBBGA&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="nombreArchivoB">
      <DTS:VariableValue
        DTS:DataType="8">TP20240229B.IBBGA</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{A2BE646D-1990-47AC-A443-71881BCEEFA7}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;TP&quot; + @[User::fechaFin] + &quot;C&quot;+&quot;.IBBGA&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="nombreArchivoC">
      <DTS:VariableValue
        DTS:DataType="8">TP20240229C.IBBGA</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{864A78BF-4545-41A2-8D78-0EB817E0DB9D}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[$Project::ruta]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="rutaArchivo">
      <DTS:VariableValue
        DTS:DataType="8">C:\Users\andres.quinteros\Desktop\Infraestructura de data\Arquitectura de datos\ARQ - ArchivoC Ahorristas - OP-7078\Export\</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3216ED4F-BAA6-4E33-98A5-AD47B2983762}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::rutaArchivo] +  @[User::nombreArchivoC]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="rutaCompleta">
      <DTS:VariableValue
        DTS:DataType="8">C:\Users\andres.quinteros\Desktop\Infraestructura de data\Arquitectura de datos\ARQ - ArchivoC Ahorristas - OP-7078\Export\TP20240229C.IBBGA</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Archivo A"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Contenedor de secuencias"
      DTS:DTSID="{0a98a925-0d8e-4fc7-9e57-cc3a615bc96e}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Archivo A">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Archivo A\Correo Correcto"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Tarea Ejecutar SQL"
          DTS:DTSID="{884c7ae4-f5ef-46c7-ab2d-d0f973307875}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Correo Correcto"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="2">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="SqlStatementSource">"UPDATE asfi.control_ejecuciones_reportes_automaticos
        SET ESTADO_PROCESO = '0',  
            DETALLE_PROCESO = 'Proceso Finalizado Correcto - 001_RPT_Ahorrista_OP_7078.dtsx',
			PARAMETROS = PARAMETROS + '|NOM_ARCHIVO_A="+ @[User::nombreArchivoA] +"'
        WHERE ID_PROCESO = "+  (DT_WSTR, 25) @[$Project::idProceso] +";

USE MSDB; EXEC [dbo].[p_email_generico_reportes_ASFI]
    0,  -- TIPO 
    'DW: Reporte "+ @[User::nombreArchivoA]   +"',  -- ASUNTO 
    'Reporte de Ahorristas - Archivo C Generado Correctamente a corte "+ @[User::fechaFin] +"',  -- TITULO
    'El reporte de ahorristas ha sido generado exitosamente y se ha almacenado en la carpeta compartida.',  -- TEXTO
    '"+ @[User::correos] +"',  -- CORREOS
    '"+ @[User::rutaArchivo] +"';"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{0828E80A-351C-40CD-950C-99EBC714113F}"
              SQLTask:SqlStatementSource="UPDATE asfi.control_ejecuciones_reportes_automaticos&#xA;        SET ESTADO_PROCESO = '0',  &#xA;            DETALLE_PROCESO = 'Proceso Finalizado Correcto - 001_RPT_Ahorrista_OP_7078.dtsx',&#xA;&#x9;&#x9;&#x9;PARAMETROS = PARAMETROS + '|NOM_ARCHIVO_A=TP20240229A.IBBGA'&#xA;        WHERE ID_PROCESO = 0;&#xA;&#xA;USE MSDB; EXEC [dbo].[p_email_generico_reportes_ASFI]&#xA;    0,  -- TIPO &#xA;    'DW: Reporte TP20240229A.IBBGA',  -- ASUNTO &#xA;    'Reporte de Ahorristas - Archivo C Generado Correctamente a corte 20240229',  -- TITULO&#xA;    'El reporte de ahorristas ha sido generado exitosamente y se ha almacenado en la carpeta compartida.',  -- TEXTO&#xA;    'adquinteros@bg.com.bo;paulo.salazar@bg.com.bo',  -- CORREOS&#xA;    'C:\Users\andres.quinteros\Desktop\Infraestructura de data\Arquitectura de datos\ARQ - ArchivoC Ahorristas - OP-7078\Export\';" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Archivo A\Correo Error"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Tarea Ejecutar SQL"
          DTS:DTSID="{390cc955-4197-4205-8a6c-867c14a2574e}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Correo Error"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="3">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="SqlStatementSource">"UPDATE asfi.control_ejecuciones_reportes_automaticos
        SET ESTADO_PROCESO = '2',  
            DETALLE_PROCESO = 'ERROR EN EL PAQUETE SSIS - 001_RPT_Ahorrista_OP_7078.dtsx'
        WHERE ID_PROCESO = "+  (DT_WSTR, 25) @[$Project::idProceso] +";
USE MSDB; 
EXEC [dbo].[p_email_generico_reportes_ASFI]
    1,  -- TIPO (para manejar el caso de error)
    'DW: Error en la Generación del Reporte "+  @[User::nombreArchivoC]  +"',  -- ASUNTO 
    'Error en la Generación del Reporte de Ahorristas - Archivo C',  -- TITULO
    'Ocurrió un error durante la generación del reporte de ahorristas. Por favor, contactar con el area de BI / Infraestructura de data.',  -- TEXTO
    '"+ @[User::correos] +"',  -- CORREOS
    '"+ @[User::rutaArchivo]  +"'   -- RUTA_ARCHIVO"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{0828E80A-351C-40CD-950C-99EBC714113F}"
              SQLTask:SqlStatementSource="UPDATE asfi.control_ejecuciones_reportes_automaticos&#xA;        SET ESTADO_PROCESO = '2',  &#xA;            DETALLE_PROCESO = 'ERROR EN EL PAQUETE SSIS - 001_RPT_Ahorrista_OP_7078.dtsx'&#xA;        WHERE ID_PROCESO = 0;&#xA;USE MSDB; &#xA;EXEC [dbo].[p_email_generico_reportes_ASFI]&#xA;    1,  -- TIPO (para manejar el caso de error)&#xA;    'DW: Error en la Generación del Reporte TP20240229C.IBBGA',  -- ASUNTO &#xA;    'Error en la Generación del Reporte de Ahorristas - Archivo C',  -- TITULO&#xA;    'Ocurrió un error durante la generación del reporte de ahorristas. Por favor, contactar con el area de BI / Infraestructura de data.',  -- TEXTO&#xA;    'adquinteros@bg.com.bo;paulo.salazar@bg.com.bo',  -- CORREOS&#xA;    'C:\Users\andres.quinteros\Desktop\Infraestructura de data\Arquitectura de datos\ARQ - ArchivoC Ahorristas - OP-7078\Export\'   -- RUTA_ARCHIVO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Archivo A\Data Flow Task"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Data Flow Task"
          DTS:DTSID="{6761b13e-494b-4188-bcd7-017805ca94a2}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Data Flow Task"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="[Origen de ADO NET].[SqlCommand]">"SELECT 
	  to_date(i.fechacorte,'dd/mm/yyyy') FECHACORTE,
      i.CODENVIO,--'IBBGA',
      i.MODALIDAD,
      i.ESTADO,
      i.clasificacion_suma_saldos,
      i.rango_tasa_pagada, 
      i.tipo_persona,
      i.moneda,
      i.saldo_deposito,
      i.cantidad_cuentas
      
      FROM (

SELECT 
 	FECHA_SALDO FECHACORTE,
 	'IBBGA' CODENVIO,
 	 	CASE 
 		WHEN MANEJO_CUENTA = 'I' THEN 1
 		ELSE 2
 	END MODALIDAD, 	 	
 	
 	CASE 
 		WHEN RTRIM(ESTADO_DESCR_ASFI) LIKE '%ACTIVA%' THEN 1 
 		WHEN RTRIM(ESTADO_DESCR_ASFI) LIKE '%CLAUSURADA%' THEN 3 
 		ELSE 2
 	END ESTADO , 
 	CASE 
 		WHEN SUM(SALDO_BS)/COUNT(CUENTA) &lt;= 70000 THEN 1
 		ELSE 2
 	END  CLASIFICACION_SUMA_SALDOS,
    CASE
        WHEN TASA &lt;= 0.99 				   THEN '1' 
        WHEN TASA &gt;= 1 AND TASA &lt;= 1.99    THEN '2'
        WHEN TASA &gt;= 2 AND TASA &lt;= 2.99    THEN '3' 
        WHEN TASA &gt;= 3 AND TASA &lt;= 3.99    THEN '4'
        WHEN TASA &gt;= 4					   THEN '5'
        ELSE '6'
 	END RANGO_TASA_PAGADA,
 	TIPO_PERSONA,
 	CASE 
 		WHEN MONEDA = '9800' THEN '4' 
 		WHEN MONEDA = '9900' THEN '3' 
 		WHEN MONEDA = '0'    THEN '1' 
 		ELSE '2'				      
 	END MONEDA, 	
 	LTRIM(RTRIM(TO_CHAR(SUM(SALDO_BS),'999999999999.99'))) SALDO_DEPOSITO, 	
 	COUNT(CUENTA) CANTIDAD_CUENTAS
 FROM 
 ( 
 SELECT 
 		  TO_NUMBER (RES.JTS_OID) JTS_OID,
          TO_NUMBER (RES.CUENTA) CUENTA,
          TO_CHAR (RES.MANEJOCUENTA) MANEJO_CUENTA,
		  CUENTA_ACTIVA,
          TO_CHAR (RES.RETIENEIVA) RETIENE_IVA,
          CASE
             WHEN RES.TIPODOCUMENTO = 'CI' THEN TO_CHAR (RES.CI) || ' ' || TO_CHAR (RES.EXT_CI)
             ELSE RES.OTRO_DOCUMENTO
          END NRO_DOC_IDENTIDAD,
          RES.nombrecliente NOMBRE,
          TO_NUMBER (RES.NUMEROPERSONA) CODIGO_PERSONA,
          RES.NOMBRE_PERSONA,
          TO_NUMBER (RES.NROCLIENTE) NRO_CLIENTE,
          TO_CHAR (RES.FECHAAPERTURA, 'dd/mm/yyyy') FECHA_APERTURA,
          TO_CHAR (RES.FECHASALDO, 'dd/mm/yyyy') FECHA_SALDO,
          ROUND (RES.SALDO_MO, 2) SALDO_MO,
          ROUND (RES.SALDO_BS, 2) SALDO_BS,
          ROUND (SALDO_PROMEDIO_BS, 2) SALDO_PROMEDIO_BS,
          ROUND (RES.SALDO_US, 2) SALDO_US,
          ROUND (RES.SALDO_PIGNORADO_MO, 2) SALDO_PIGNORADO_MO,
          ROUND (RES.SALDO_PIGNORADO_BS, 2) SALDO_PIGNORADO_BS,
          ROUND (RES.SALDO_PIGNORADO_US, 2) SALDO_PIGNORADO_US,
          TO_NUMBER (RES.MONEDA) MONEDA,
          ROUND(RES.tasainterespago, 2) tasa,
          CASE
             WHEN RES.codcancelacion = '1' THEN RES.codcancelacion
             ELSE RES.codctainmov
          END COD_ESTADO,
          CASE
             WHEN RES.codcancelacion = '1' THEN 'CERRADA'
             ELSE RES.DESCRIPCION
          END DESC_ESTADO,
          CASE
             WHEN RES.codcancelacion = '1' THEN 'CERRADA'
             ELSE OP1.DESCRIPCION 
          END ESTADO_DESCR_ASFI,
          TO_CHAR (FECHA_CAMBIO_ESTADO, 'dd/mm/yyyy') FECHA_CAMBIO_ESTADO,
          ROUND (RES.INT_DEVENGADO_MO, 2) INT_DEVENGADO_MO,
          ROUND (RES.INT_DEVENGADO_BS, 2) INT_DEVENGADO_BS,
          ROUND (RES.INT_DEVENGADO_US, 2) INT_DEVENGADO_US,
          TO_CHAR (RES.FECHA, 'dd/mm/yyyy') FECHA_DEVENGADO,
          TO_CHAR (RES.FECHA, 'dd/mm/yyyy') FECHA_ULT_PAGO_INT,
          TO_CHAR (RES.FECHA_ULT_MOV, 'dd/mm/yyyy') FECHA_ULT_MOV,
          RES.TIPO_PERSONA,
          DECODE (
             RES.TIPO_PERSONA,
             'F', 'PERSONA NATURAL',
             'J', (SELECT tp.descripcion
                     FROM cli_personasjuridicas J, cli_tipo_persona_jur TP
                    WHERE     numeropersonajuridica = RES.Nro_PERSONA
                          AND codigotipo = j.tipoempresa
                          AND ROWNUM = 1),
             RES.TIPO_PERSONA)
             AS TIPO_CLIENTE,
          TO_NUMBER (RES.CTA_CONTABLE_SALDO) CTA_CONTABLE_SALDO,
          TO_NUMBER (RES.CTA_CONTABLE_INTERES) CTA_CONTABLE_INTERES,
          TO_NUMBER (RES.PRODUCTO) COD_PRODUCTO,
          RES.DESC_PRODUCTO,
          TO_NUMBER (RES.COD_PLAZA) COD_PLAZA,
          RES.DESC_PLAZA,
          TO_NUMBER (RES.COD_SUCURSAL) COD_SUCURSAL,
          RES.DESC_SUCURSAL,
          TO_NUMBER (TRIM (RES.EJECUTIVOCLIENTE)) CODIGO_OFICIAL,
          RES.NOMBRE_OFICIAL
FROM (
SELECT s.jts_oid,
                  H.cuenta,
                  s.C1686 ManejoCuenta,
				  s.C1651 CUENTA_ACTIVA,
                  CASE
                     WHEN (SELECT COUNT (tipodocumento)
                             FROM cli_documentospfpj
                            WHERE     numeropersonafj = CP.NUMEROPERSONA
                                  AND tipodocumento = 'NIT'
                                  AND tz_lock = 0) &gt; 0
                     THEN 'N'
                     ELSE 'S'
                  END  RETIENEIVA,
                  c.nombrecliente,
                  H.C1803 NROCLIENTE,
                  CP.NUMEROPERSONA,
                  NVL (PF.NOMBRECOMPLETO, PJ.RAZONSOCIAL) NOMBRE_PERSONA,
                  CASE
                     WHEN g.fecha &lt; (SELECT SYSDATE FROM DUAL)
                     THEN H.c1651
                     ELSE s.C1651
                  END codcancelacion,
                  CASE
                     WHEN G.FECHA &lt; (SELECT SYSDATE FROM DUAL)
                     THEN
                        (SELECT O.DESCRIPCION
                           FROM OPCIONES O
                          WHERE     O.NUMERODECAMPO = 1679 AND O.IDIOMA = 'E' AND O.OPCIONINTERNA = H.C1679)
                     ELSE
                        (SELECT O.DESCRIPCION
                           FROM OPCIONES O
                          WHERE     O.NUMERODECAMPO = 1679 AND O.IDIOMA = 'E' AND O.OPCIONINTERNA = s.C1679)
                  END DESCRIPCION,
                  CASE
                     WHEN g.fecha &lt; (SELECT SYSDATE FROM DUAL)
                     THEN  H.c1679
                     ELSE H.C1679
                  END codctainmov,
                  g.fecha,
                  H.C1621 FECHAAPERTURA,
                  g.fecha FECHASALDO,
                  g.saldo_ajustado SALDO_MO,
                  (g.saldo_ajustado * m.tipo_cambio_bcu) SALDO_BS,
                  (GM.PROMEDIO_MENSUAL * m.tipo_cambio_bcu) SALDO_PROMEDIO_BS,
                  DECODE (H.moneda,
                          0, (g.saldo_ajustado / m.arbitraje_venta),
                          9800, (g.saldo_ajustado / m.arbitraje_cierre_bcu),
                          (g.saldo_ajustado * m.arbitraje_cierre_bcu))
                     SALDO_US,
                  H.C2627 SALDO_PIGNORADO_MO,
                  (H.C2627 * m.tipo_cambio_bcu)
                     SALDO_PIGNORADO_BS,
                  DECODE (
                     H.moneda,
                     0, (H.C2627 / m.arbitraje_venta),
                     9800, (H.C2627 / m.arbitraje_cierre_bcu),
                     (H.C2627 * m.arbitraje_cierre_bcu))
                     SALDO_PIGNORADO_US,
                  H.MONEDA,
                  CASE 
                     WHEN (g.saldo_ajustado * m.tipo_cambio_bcu) &lt;=70000 AND g.tasainterespago &lt; 2 AND C.TIPO_PERSONA = 3 THEN 2
                     ELSE g.tasainterespago
                  END tasainterespago,
                  GANADERO.FUN_VISTA_OBTFECHA_CAM_ESTADO (s.jts_oid,g.fecha,s.c1620) FECHA_CAMBIO_ESTADO,
                  g.fecha FECHADEVENGADO,
                  g.interesespago INT_DEVENGADO_MO,
                  (g.interesespago * m.tipo_cambio_bcu) INT_DEVENGADO_BS,
                  DECODE (H.moneda,
                          0, (g.interesespago / m.arbitraje_venta),
                          9800, (g.interesespago / m.arbitraje_cierre_bcu),
                          (g.interesespago * m.arbitraje_cierre_bcu))
                     INT_DEVENGADO_US,
                  H.C1813 FECHA_DEVENGADO,
                  H.C1817 FECHA_ULT_PAGO_INT, 
                  H.c1626 FECHA_ULT_MOV,
                  g.rubrocontable CTA_CONTABLE_SALDO,
                  (SELECT e.rubrosalida
                     FROM ganadero.esquemacontable e
                    WHERE e.campo = 583 AND e.condicion = 'C584=0' AND e.rubro = p.c6271 AND e.rubrosalida LIKE '411%')
                     cta_contable_interes,
                  H.producto,
                  p.C6251 desc_producto,
                  a.cod_plaza,
                  a.DESCRIPCION desc_plaza,
                  H.sucursal cod_sucursal,
                  u.NOMBRESUCURSAL desc_sucursal,
                  c.ejecutivocliente,
                  (SELECT nombreofic
                     FROM cli_oficuenta
                    WHERE codoficial = c.ejecutivocliente) nombre_oficial,
               CASE 
                  WHEN C.TIPO_PERSONA = 3	THEN	'1'
                  WHEN C.TIPO_PERSONA = 2	THEN	'2'
                  ELSE '3'
               END TIPO_PERSONA,
                  (SELECT nropersona
                     FROM vw_personastodas
                    WHERE nropersona IN
                             (SELECT numeropersona
                                FROM cli_clientepersona
                               WHERE     codigocliente = H.C1803 AND titularidad = 'T')) Nro_PERSONA,
                  (SELECT numerodocumento
                     FROM cli_documentospfpj
                    WHERE     numeropersonafj = CP.NUMEROPERSONA AND tipodocumento = 'CI'AND tz_lock = 0) CI,
                  (SELECT ext_documento
                     FROM cli_documentospfpj
                    WHERE     numeropersonafj = CP.NUMEROPERSONA AND TIPODOCUMENTO = 'CI' AND tz_lock = 0) EXT_CI,
                  (SELECT numerodocumento
                     FROM cli_documentospfpj
                    WHERE     numeropersonafj = CP.NUMEROPERSONA AND tipodocumento = 'NIT' AND tz_lock = 0) NIT,
                  (SELECT tipodocumento || '-' || numerodocumento
                     FROM cli_documentospfpj
                    WHERE     numeropersonafj = CP.NUMEROPERSONA AND tipodocumento NOT IN ('CI', 'NIT') AND tz_lock = 0 AND ROWNUM = 1)  OTROS_DOCUMENTOS,
                  (SELECT NUMERODOCUMENTO
                     FROM CLI_DOCUMENTOSPFPJ
                    WHERE     NUMEROPERSONAFJ = CP.NUMEROPERSONA
                          AND TIPODOCUMENTO NOT IN ('CI') AND TZ_LOCK = 0 AND REPORTAAORGANISMOCONTROL = 'S') OTRO_DOCUMENTO,
                  (SELECT TIPODOCUMENTO
                     FROM CLI_DOCUMENTOSPFPJ
                    WHERE     NUMEROPERSONAFJ = CP.NUMEROPERSONA AND TZ_LOCK = 0 AND REPORTAAORGANISMOCONTROL = 'S') TIPODOCUMENTO
             FROM saldos s,
                  grl_saldos_diarios G, GANADERO.GRL_SALDOS_MENSUALES GM, 
                  productos P, sucursales U, plazas a, 
                  bg_saldos_hist H,  HISTORICOTIPOSCAMBIO M,  cli_clientes C
                  LEFT JOIN CLI_CLIENTEPERSONA CP ON (C.CODIGOCLIENTE = CP.CODIGOCLIENTE AND CP.TZ_LOCK = 0 AND CP.TITULARIDAD = 'T')
                  LEFT JOIN CLI_PERSONASFISICAS PF ON (CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0)
                  LEFT JOIN CLI_PERSONASJURIDICAS PJ ON (CP.NUMEROPERSONA = PJ.NUMEROPERSONAJURIDICA AND PJ.TZ_LOCK = 0)
            WHERE     H.C1785 = 3
                  AND s.jts_oid = g.saldos_jts_oid  
                  AND g.fecha = TO_DATE('"+ @[User::fechaFin] +"','yyyymmdd')
                  AND c.codigocliente = H.C1803
                  AND g.saldo_ajustado &lt;&gt; 0
                  AND p.C6250 = H.producto
                  AND u.sucursal = H.sucursal
                  AND a.cod_plaza = u.CODDEPARTAMENTO
                  AND H.jts_oid = s.jts_oid AND H.jts_oid = GM.saldos_jts_oid 
                  AND H.fecha_hist = g.fecha AND GM.FECHA = TO_DATE('"+ @[User::fechaFin] +"','yyyymmdd')			
                  AND m.moneda = H.moneda
                  AND m.fecha_cotizacion = g.fecha
                  AND G.RUBROCONTABLE NOT IN (2440512001, 2440522001, 2440542001) 
        ) RES  LEFT JOIN ganadero.ESTADO_ASFI EA ON EA.BLOQUEO = codctainmov
        	  LEFT JOIN OPCIONES OP1 ON OP1.NUMERODECAMPO=14292 AND OP1.IDIOMA = 'E' AND EA.ESTADO_ASFI = OP1.OPCIONINTERNA
) TB
WHERE SUBSTR(TB.CTA_CONTABLE_SALDO,0,5) IN ('21201','21202','23507','23508','28201','28202')
GROUP BY 
	FECHA_SALDO ,
 	'BGA',
	CASE 
 		WHEN MANEJO_CUENTA = 'I' THEN 1
 		ELSE 2
 	END , 	
	
 	CASE 
 		WHEN RTRIM(ESTADO_DESCR_ASFI) LIKE '%ACTIVA%' THEN 1 
 		WHEN RTRIM(ESTADO_DESCR_ASFI) LIKE '%CLAUSURADA%' THEN 3 
 		ELSE 2 
 	END , 
 	
    CASE
        WHEN TASA &lt;= 0.99 				   THEN '1'
        WHEN TASA &gt;= 1 AND TASA &lt;= 1.99    THEN '2'
        WHEN TASA &gt;= 2 AND TASA &lt;= 2.99    THEN '3'
        WHEN TASA &gt;= 3 AND TASA &lt;= 3.99    THEN '4'
        WHEN TASA &gt;= 4					   THEN '5'
        ELSE '6'
 	END ,
 TIPO_PERSONA,
 	CASE 
 		WHEN MONEDA = '9800' THEN '4'
 		WHEN MONEDA = '9900' THEN '3'
 		WHEN MONEDA = '0' 	 THEN '1'
 		ELSE '2'				
 	END ) i "</DTS:PropertyExpression>
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Archivo A\Data Flow Task\Flat File Destination"
                  componentClassID="Microsoft.FlatFileDestination"
                  contactInfo="Flat File Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                  description="Flat File Destination"
                  localeId="16394"
                  name="Flat File Destination"
                  version="1">
                  <properties>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether the data will overwrite or append to the destination file."
                      name="Overwrite">true</property>
                    <property
                      dataType="System.Null"
                      description="Specifies the text to write to the destination file before any data is written."
                      expressionType="Notify"
                      name="Header" />
                    <property
                      dataType="System.Boolean"
                      description="When text qualifier is enabled, specifies whether the text qualifier in the data written to the destination file will be escaped or not."
                      name="EscapeQualifier">false</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Archivo A\Data Flow Task\Flat File Destination.Connections[FlatFileConnection]"
                      connectionManagerID="Package.ConnectionManagers[ArchivoA]"
                      connectionManagerRefId="Package.ConnectionManagers[ArchivoA]"
                      name="FlatFileConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input]"
                      hasSideEffects="true"
                      name="Flat File Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[FECHACORTE]"
                          cachedDataType="dbTimeStamp"
                          cachedName="FECHACORTE"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[FECHACORTE]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[FECHACORTE]" />
                        <inputColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[CODENVIO]"
                          cachedDataType="wstr"
                          cachedLength="5"
                          cachedName="CODENVIO"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CODENVIO]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[CODENVIO]" />
                        <inputColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[MODALIDAD]"
                          cachedDataType="numeric"
                          cachedName="MODALIDAD"
                          cachedPrecision="38"
                          cachedScale="4"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[MODALIDAD]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[MODALIDAD]" />
                        <inputColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[ESTADO]"
                          cachedDataType="numeric"
                          cachedName="ESTADO"
                          cachedPrecision="38"
                          cachedScale="4"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[ESTADO]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[ESTADO]" />
                        <inputColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[CLASIFICACION_SUMA_SALDOS]"
                          cachedDataType="numeric"
                          cachedName="CLASIFICACION_SUMA_SALDOS"
                          cachedPrecision="38"
                          cachedScale="4"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CLASIFICACION_SUMA_SALDOS]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[CLASIFICACION_SUMA_SALDOS]" />
                        <inputColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[RANGO_TASA_PAGADA]"
                          cachedDataType="wstr"
                          cachedLength="1"
                          cachedName="RANGO_TASA_PAGADA"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[RANGO_TASA_PAGADA]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[RANGO_TASA_PAGADA]" />
                        <inputColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[TIPO_PERSONA]"
                          cachedDataType="wstr"
                          cachedLength="1"
                          cachedName="TIPO_PERSONA"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[TIPO_PERSONA]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[TIPO_PERSONA]" />
                        <inputColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[MONEDA]"
                          cachedDataType="wstr"
                          cachedLength="1"
                          cachedName="MONEDA"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[MONEDA]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[MONEDA]" />
                        <inputColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[SALDO_DEPOSITO]"
                          cachedDataType="wstr"
                          cachedLength="16"
                          cachedName="SALDO_DEPOSITO"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[SALDO_DEPOSITO]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[SALDO_DEPOSITO]" />
                        <inputColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[CANTIDAD_CUENTAS]"
                          cachedDataType="wstr"
                          cachedLength="40"
                          cachedName="CANTIDAD_CUENTAS"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CANTIDAD_CUENTAS]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[CANTIDAD_CUENTAS]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[FECHACORTE]"
                          dataType="wstr"
                          length="4000"
                          name="FECHACORTE" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CODENVIO]"
                          dataType="wstr"
                          length="5"
                          name="CODENVIO" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[MODALIDAD]"
                          dataType="numeric"
                          name="MODALIDAD"
                          precision="38"
                          scale="4" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[ESTADO]"
                          dataType="numeric"
                          name="ESTADO"
                          precision="38"
                          scale="4" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CLASIFICACION_SUMA_SALDOS]"
                          dataType="numeric"
                          name="CLASIFICACION_SUMA_SALDOS"
                          precision="38"
                          scale="4" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[RANGO_TASA_PAGADA]"
                          dataType="wstr"
                          length="1"
                          name="RANGO_TASA_PAGADA" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[TIPO_PERSONA]"
                          dataType="wstr"
                          length="1"
                          name="TIPO_PERSONA" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[MONEDA]"
                          dataType="wstr"
                          length="1"
                          name="MONEDA" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[SALDO_DEPOSITO]"
                          dataType="wstr"
                          length="16"
                          name="SALDO_DEPOSITO" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CANTIDAD_CUENTAS]"
                          dataType="wstr"
                          length="40"
                          name="CANTIDAD_CUENTAS" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                </component>
                <component
                  refId="Package\Archivo A\Data Flow Task\Origen de ADO NET"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consume datos de SQL Server, OLE DB, ODBC u Oracle mediante el correspondiente proveedor de datos de .NET Framework. Se usa una instrucción Transact-SQL para definir el conjunto de resultados. Por ejemplo, se extraen datos de SQL Server con el proveedor de datos de .NET Framework para SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; Todos los derechos reservados; http://www.microsoft.com/sql/support;4"
                  description="Consume datos de SQL Server, OLE DB, ODBC u Oracle mediante el correspondiente proveedor de datos de .NET Framework. Se usa una instrucción Transact-SQL para definir el conjunto de resultados. Por ejemplo, se extraen datos de SQL Server con el proveedor de datos de .NET Framework para SQL Server."
                  name="Origen de ADO NET"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Especifica la instrucción SQL utilizada por el componente para extraer datos."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT 
	  to_date(i.fechacorte,'dd/mm/yyyy') FECHACORTE,
      i.CODENVIO,--'IBBGA',
      i.MODALIDAD,
      i.ESTADO,
      i.clasificacion_suma_saldos,
      i.rango_tasa_pagada, 
      i.tipo_persona,
      i.moneda,
      i.saldo_deposito,
      i.cantidad_cuentas
      
      FROM (

SELECT 
 	FECHA_SALDO FECHACORTE,
 	'IBBGA' CODENVIO,
 	 	CASE 
 		WHEN MANEJO_CUENTA = 'I' THEN 1
 		ELSE 2
 	END MODALIDAD, 	 	
 	
 	CASE 
 		WHEN RTRIM(ESTADO_DESCR_ASFI) LIKE '%ACTIVA%' THEN 1 
 		WHEN RTRIM(ESTADO_DESCR_ASFI) LIKE '%CLAUSURADA%' THEN 3 
 		ELSE 2
 	END ESTADO , 
 	CASE 
 		WHEN SUM(SALDO_BS)/COUNT(CUENTA) &lt;= 70000 THEN 1
 		ELSE 2
 	END  CLASIFICACION_SUMA_SALDOS,
    CASE
        WHEN TASA &lt;= 0.99 				   THEN '1' 
        WHEN TASA &gt;= 1 AND TASA &lt;= 1.99    THEN '2'
        WHEN TASA &gt;= 2 AND TASA &lt;= 2.99    THEN '3' 
        WHEN TASA &gt;= 3 AND TASA &lt;= 3.99    THEN '4'
        WHEN TASA &gt;= 4					   THEN '5'
        ELSE '6'
 	END RANGO_TASA_PAGADA,
 	TIPO_PERSONA,
 	CASE 
 		WHEN MONEDA = '9800' THEN '4' 
 		WHEN MONEDA = '9900' THEN '3' 
 		WHEN MONEDA = '0'    THEN '1' 
 		ELSE '2'				      
 	END MONEDA, 	
 	LTRIM(RTRIM(TO_CHAR(SUM(SALDO_BS),'999999999999.99'))) SALDO_DEPOSITO, 	
 	COUNT(CUENTA) CANTIDAD_CUENTAS
 FROM 
 ( 
 SELECT 
 		  TO_NUMBER (RES.JTS_OID) JTS_OID,
          TO_NUMBER (RES.CUENTA) CUENTA,
          TO_CHAR (RES.MANEJOCUENTA) MANEJO_CUENTA,
		  CUENTA_ACTIVA,
          TO_CHAR (RES.RETIENEIVA) RETIENE_IVA,
          CASE
             WHEN RES.TIPODOCUMENTO = 'CI' THEN TO_CHAR (RES.CI) || ' ' || TO_CHAR (RES.EXT_CI)
             ELSE RES.OTRO_DOCUMENTO
          END NRO_DOC_IDENTIDAD,
          RES.nombrecliente NOMBRE,
          TO_NUMBER (RES.NUMEROPERSONA) CODIGO_PERSONA,
          RES.NOMBRE_PERSONA,
          TO_NUMBER (RES.NROCLIENTE) NRO_CLIENTE,
          TO_CHAR (RES.FECHAAPERTURA, 'dd/mm/yyyy') FECHA_APERTURA,
          TO_CHAR (RES.FECHASALDO, 'dd/mm/yyyy') FECHA_SALDO,
          ROUND (RES.SALDO_MO, 2) SALDO_MO,
          ROUND (RES.SALDO_BS, 2) SALDO_BS,
          ROUND (SALDO_PROMEDIO_BS, 2) SALDO_PROMEDIO_BS,
          ROUND (RES.SALDO_US, 2) SALDO_US,
          ROUND (RES.SALDO_PIGNORADO_MO, 2) SALDO_PIGNORADO_MO,
          ROUND (RES.SALDO_PIGNORADO_BS, 2) SALDO_PIGNORADO_BS,
          ROUND (RES.SALDO_PIGNORADO_US, 2) SALDO_PIGNORADO_US,
          TO_NUMBER (RES.MONEDA) MONEDA,
          ROUND(RES.tasainterespago, 2) tasa,
          CASE
             WHEN RES.codcancelacion = '1' THEN RES.codcancelacion
             ELSE RES.codctainmov
          END COD_ESTADO,
          CASE
             WHEN RES.codcancelacion = '1' THEN 'CERRADA'
             ELSE RES.DESCRIPCION
          END DESC_ESTADO,
          CASE
             WHEN RES.codcancelacion = '1' THEN 'CERRADA'
             ELSE OP1.DESCRIPCION 
          END ESTADO_DESCR_ASFI,
          TO_CHAR (FECHA_CAMBIO_ESTADO, 'dd/mm/yyyy') FECHA_CAMBIO_ESTADO,
          ROUND (RES.INT_DEVENGADO_MO, 2) INT_DEVENGADO_MO,
          ROUND (RES.INT_DEVENGADO_BS, 2) INT_DEVENGADO_BS,
          ROUND (RES.INT_DEVENGADO_US, 2) INT_DEVENGADO_US,
          TO_CHAR (RES.FECHA, 'dd/mm/yyyy') FECHA_DEVENGADO,
          TO_CHAR (RES.FECHA, 'dd/mm/yyyy') FECHA_ULT_PAGO_INT,
          TO_CHAR (RES.FECHA_ULT_MOV, 'dd/mm/yyyy') FECHA_ULT_MOV,
          RES.TIPO_PERSONA,
          DECODE (
             RES.TIPO_PERSONA,
             'F', 'PERSONA NATURAL',
             'J', (SELECT tp.descripcion
                     FROM cli_personasjuridicas J, cli_tipo_persona_jur TP
                    WHERE     numeropersonajuridica = RES.Nro_PERSONA
                          AND codigotipo = j.tipoempresa
                          AND ROWNUM = 1),
             RES.TIPO_PERSONA)
             AS TIPO_CLIENTE,
          TO_NUMBER (RES.CTA_CONTABLE_SALDO) CTA_CONTABLE_SALDO,
          TO_NUMBER (RES.CTA_CONTABLE_INTERES) CTA_CONTABLE_INTERES,
          TO_NUMBER (RES.PRODUCTO) COD_PRODUCTO,
          RES.DESC_PRODUCTO,
          TO_NUMBER (RES.COD_PLAZA) COD_PLAZA,
          RES.DESC_PLAZA,
          TO_NUMBER (RES.COD_SUCURSAL) COD_SUCURSAL,
          RES.DESC_SUCURSAL,
          TO_NUMBER (TRIM (RES.EJECUTIVOCLIENTE)) CODIGO_OFICIAL,
          RES.NOMBRE_OFICIAL
FROM (
SELECT s.jts_oid,
                  H.cuenta,
                  s.C1686 ManejoCuenta,
				  s.C1651 CUENTA_ACTIVA,
                  CASE
                     WHEN (SELECT COUNT (tipodocumento)
                             FROM cli_documentospfpj
                            WHERE     numeropersonafj = CP.NUMEROPERSONA
                                  AND tipodocumento = 'NIT'
                                  AND tz_lock = 0) &gt; 0
                     THEN 'N'
                     ELSE 'S'
                  END  RETIENEIVA,
                  c.nombrecliente,
                  H.C1803 NROCLIENTE,
                  CP.NUMEROPERSONA,
                  NVL (PF.NOMBRECOMPLETO, PJ.RAZONSOCIAL) NOMBRE_PERSONA,
                  CASE
                     WHEN g.fecha &lt; (SELECT SYSDATE FROM DUAL)
                     THEN H.c1651
                     ELSE s.C1651
                  END codcancelacion,
                  CASE
                     WHEN G.FECHA &lt; (SELECT SYSDATE FROM DUAL)
                     THEN
                        (SELECT O.DESCRIPCION
                           FROM OPCIONES O
                          WHERE     O.NUMERODECAMPO = 1679 AND O.IDIOMA = 'E' AND O.OPCIONINTERNA = H.C1679)
                     ELSE
                        (SELECT O.DESCRIPCION
                           FROM OPCIONES O
                          WHERE     O.NUMERODECAMPO = 1679 AND O.IDIOMA = 'E' AND O.OPCIONINTERNA = s.C1679)
                  END DESCRIPCION,
                  CASE
                     WHEN g.fecha &lt; (SELECT SYSDATE FROM DUAL)
                     THEN  H.c1679
                     ELSE H.C1679
                  END codctainmov,
                  g.fecha,
                  H.C1621 FECHAAPERTURA,
                  g.fecha FECHASALDO,
                  g.saldo_ajustado SALDO_MO,
                  (g.saldo_ajustado * m.tipo_cambio_bcu) SALDO_BS,
                  (GM.PROMEDIO_MENSUAL * m.tipo_cambio_bcu) SALDO_PROMEDIO_BS,
                  DECODE (H.moneda,
                          0, (g.saldo_ajustado / m.arbitraje_venta),
                          9800, (g.saldo_ajustado / m.arbitraje_cierre_bcu),
                          (g.saldo_ajustado * m.arbitraje_cierre_bcu))
                     SALDO_US,
                  H.C2627 SALDO_PIGNORADO_MO,
                  (H.C2627 * m.tipo_cambio_bcu)
                     SALDO_PIGNORADO_BS,
                  DECODE (
                     H.moneda,
                     0, (H.C2627 / m.arbitraje_venta),
                     9800, (H.C2627 / m.arbitraje_cierre_bcu),
                     (H.C2627 * m.arbitraje_cierre_bcu))
                     SALDO_PIGNORADO_US,
                  H.MONEDA,
                  CASE 
                     WHEN (g.saldo_ajustado * m.tipo_cambio_bcu) &lt;=70000 AND g.tasainterespago &lt; 2 AND C.TIPO_PERSONA = 3 THEN 2
                     ELSE g.tasainterespago
                  END tasainterespago,
                  GANADERO.FUN_VISTA_OBTFECHA_CAM_ESTADO (s.jts_oid,g.fecha,s.c1620) FECHA_CAMBIO_ESTADO,
                  g.fecha FECHADEVENGADO,
                  g.interesespago INT_DEVENGADO_MO,
                  (g.interesespago * m.tipo_cambio_bcu) INT_DEVENGADO_BS,
                  DECODE (H.moneda,
                          0, (g.interesespago / m.arbitraje_venta),
                          9800, (g.interesespago / m.arbitraje_cierre_bcu),
                          (g.interesespago * m.arbitraje_cierre_bcu))
                     INT_DEVENGADO_US,
                  H.C1813 FECHA_DEVENGADO,
                  H.C1817 FECHA_ULT_PAGO_INT, 
                  H.c1626 FECHA_ULT_MOV,
                  g.rubrocontable CTA_CONTABLE_SALDO,
                  (SELECT e.rubrosalida
                     FROM ganadero.esquemacontable e
                    WHERE e.campo = 583 AND e.condicion = 'C584=0' AND e.rubro = p.c6271 AND e.rubrosalida LIKE '411%')
                     cta_contable_interes,
                  H.producto,
                  p.C6251 desc_producto,
                  a.cod_plaza,
                  a.DESCRIPCION desc_plaza,
                  H.sucursal cod_sucursal,
                  u.NOMBRESUCURSAL desc_sucursal,
                  c.ejecutivocliente,
                  (SELECT nombreofic
                     FROM cli_oficuenta
                    WHERE codoficial = c.ejecutivocliente) nombre_oficial,
               CASE 
                  WHEN C.TIPO_PERSONA = 3	THEN	'1'
                  WHEN C.TIPO_PERSONA = 2	THEN	'2'
                  ELSE '3'
               END TIPO_PERSONA,
                  (SELECT nropersona
                     FROM vw_personastodas
                    WHERE nropersona IN
                             (SELECT numeropersona
                                FROM cli_clientepersona
                               WHERE     codigocliente = H.C1803 AND titularidad = 'T')) Nro_PERSONA,
                  (SELECT numerodocumento
                     FROM cli_documentospfpj
                    WHERE     numeropersonafj = CP.NUMEROPERSONA AND tipodocumento = 'CI'AND tz_lock = 0) CI,
                  (SELECT ext_documento
                     FROM cli_documentospfpj
                    WHERE     numeropersonafj = CP.NUMEROPERSONA AND TIPODOCUMENTO = 'CI' AND tz_lock = 0) EXT_CI,
                  (SELECT numerodocumento
                     FROM cli_documentospfpj
                    WHERE     numeropersonafj = CP.NUMEROPERSONA AND tipodocumento = 'NIT' AND tz_lock = 0) NIT,
                  (SELECT tipodocumento || '-' || numerodocumento
                     FROM cli_documentospfpj
                    WHERE     numeropersonafj = CP.NUMEROPERSONA AND tipodocumento NOT IN ('CI', 'NIT') AND tz_lock = 0 AND ROWNUM = 1)  OTROS_DOCUMENTOS,
                  (SELECT NUMERODOCUMENTO
                     FROM CLI_DOCUMENTOSPFPJ
                    WHERE     NUMEROPERSONAFJ = CP.NUMEROPERSONA
                          AND TIPODOCUMENTO NOT IN ('CI') AND TZ_LOCK = 0 AND REPORTAAORGANISMOCONTROL = 'S') OTRO_DOCUMENTO,
                  (SELECT TIPODOCUMENTO
                     FROM CLI_DOCUMENTOSPFPJ
                    WHERE     NUMEROPERSONAFJ = CP.NUMEROPERSONA AND TZ_LOCK = 0 AND REPORTAAORGANISMOCONTROL = 'S') TIPODOCUMENTO
             FROM saldos s,
                  grl_saldos_diarios G, GANADERO.GRL_SALDOS_MENSUALES GM, 
                  productos P, sucursales U, plazas a, 
                  bg_saldos_hist H,  HISTORICOTIPOSCAMBIO M,  cli_clientes C
                  LEFT JOIN CLI_CLIENTEPERSONA CP ON (C.CODIGOCLIENTE = CP.CODIGOCLIENTE AND CP.TZ_LOCK = 0 AND CP.TITULARIDAD = 'T')
                  LEFT JOIN CLI_PERSONASFISICAS PF ON (CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0)
                  LEFT JOIN CLI_PERSONASJURIDICAS PJ ON (CP.NUMEROPERSONA = PJ.NUMEROPERSONAJURIDICA AND PJ.TZ_LOCK = 0)
            WHERE     H.C1785 = 3
                  AND s.jts_oid = g.saldos_jts_oid  
                  AND g.fecha = TO_DATE('20240229','yyyymmdd')
                  AND c.codigocliente = H.C1803
                  AND g.saldo_ajustado &lt;&gt; 0
                  AND p.C6250 = H.producto
                  AND u.sucursal = H.sucursal
                  AND a.cod_plaza = u.CODDEPARTAMENTO
                  AND H.jts_oid = s.jts_oid AND H.jts_oid = GM.saldos_jts_oid 
                  AND H.fecha_hist = g.fecha AND GM.FECHA = TO_DATE('20240229','yyyymmdd')			
                  AND m.moneda = H.moneda
                  AND m.fecha_cotizacion = g.fecha
                  AND G.RUBROCONTABLE NOT IN (2440512001, 2440522001, 2440542001) 
        ) RES  LEFT JOIN ganadero.ESTADO_ASFI EA ON EA.BLOQUEO = codctainmov
        	  LEFT JOIN OPCIONES OP1 ON OP1.NUMERODECAMPO=14292 AND OP1.IDIOMA = 'E' AND EA.ESTADO_ASFI = OP1.OPCIONINTERNA
) TB
WHERE SUBSTR(TB.CTA_CONTABLE_SALDO,0,5) IN ('21201','21202','23507','23508','28201','28202')
GROUP BY 
	FECHA_SALDO ,
 	'BGA',
	CASE 
 		WHEN MANEJO_CUENTA = 'I' THEN 1
 		ELSE 2
 	END , 	
	
 	CASE 
 		WHEN RTRIM(ESTADO_DESCR_ASFI) LIKE '%ACTIVA%' THEN 1 
 		WHEN RTRIM(ESTADO_DESCR_ASFI) LIKE '%CLAUSURADA%' THEN 3 
 		ELSE 2 
 	END , 
 	
    CASE
        WHEN TASA &lt;= 0.99 				   THEN '1'
        WHEN TASA &gt;= 1 AND TASA &lt;= 1.99    THEN '2'
        WHEN TASA &gt;= 2 AND TASA &lt;= 2.99    THEN '3'
        WHEN TASA &gt;= 3 AND TASA &lt;= 3.99    THEN '4'
        WHEN TASA &gt;= 4					   THEN '5'
        ELSE '6'
 	END ,
 TIPO_PERSONA,
 	CASE 
 		WHEN MONEDA = '9800' THEN '4'
 		WHEN MONEDA = '9900' THEN '3'
 		WHEN MONEDA = '0' 	 THEN '1'
 		ELSE '2'				
 	END ) i </property>
                    <property
                      dataType="System.Int32"
                      description="Número de segundos antes de que se agote el tiempo de espera de un comando. Un valor de 0 indica un tiempo de espera infinito."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indica si se debe permitir que columnas externas que no sean de cadenas se conviertan implícitamente en cadenas en las columnas de salida."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="Nombre de la tabla de la base de datos de origen."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Especificar el modo de recuperar información de columnas externas"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Connections[IDbConnection]"
                      connectionManagerID="{413BF411-79F6-4190-B17F-9BDFA39EBB0B}:external"
                      connectionManagerRefId="Project.ConnectionManagers[LCBGDB2.dmart_app]"
                      description="Administrador de conexiones administrado"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET]"
                      name="Salida de origen de ADO NET">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[FECHACORTE]"
                          dataType="dbTimeStamp"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[FECHACORTE]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[FECHACORTE]"
                          name="FECHACORTE"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[CODENVIO]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[CODENVIO]"
                          length="5"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[CODENVIO]"
                          name="CODENVIO"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[MODALIDAD]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[MODALIDAD]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[MODALIDAD]"
                          name="MODALIDAD"
                          precision="38"
                          scale="4"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[ESTADO]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[ESTADO]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[ESTADO]"
                          name="ESTADO"
                          precision="38"
                          scale="4"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[CLASIFICACION_SUMA_SALDOS]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[CLASIFICACION_SUMA_SALDOS]"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[CLASIFICACION_SUMA_SALDOS]"
                          name="CLASIFICACION_SUMA_SALDOS"
                          precision="38"
                          scale="4"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[RANGO_TASA_PAGADA]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[RANGO_TASA_PAGADA]"
                          length="1"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[RANGO_TASA_PAGADA]"
                          name="RANGO_TASA_PAGADA"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[TIPO_PERSONA]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[TIPO_PERSONA]"
                          length="1"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[TIPO_PERSONA]"
                          name="TIPO_PERSONA"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[MONEDA]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[MONEDA]"
                          length="1"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[MONEDA]"
                          name="MONEDA"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[SALDO_DEPOSITO]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[SALDO_DEPOSITO]"
                          length="16"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[SALDO_DEPOSITO]"
                          name="SALDO_DEPOSITO"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[CANTIDAD_CUENTAS]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[CANTIDAD_CUENTAS]"
                          length="40"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].Columns[CANTIDAD_CUENTAS]"
                          name="CANTIDAD_CUENTAS"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[FECHACORTE]"
                          dataType="dbTimeStamp"
                          name="FECHACORTE" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[CODENVIO]"
                          dataType="wstr"
                          length="5"
                          name="CODENVIO" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[MODALIDAD]"
                          dataType="numeric"
                          name="MODALIDAD"
                          precision="38"
                          scale="4" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[ESTADO]"
                          dataType="numeric"
                          name="ESTADO"
                          precision="38"
                          scale="4" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[CLASIFICACION_SUMA_SALDOS]"
                          dataType="numeric"
                          name="CLASIFICACION_SUMA_SALDOS"
                          precision="38"
                          scale="4" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[RANGO_TASA_PAGADA]"
                          dataType="wstr"
                          length="1"
                          name="RANGO_TASA_PAGADA" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[TIPO_PERSONA]"
                          dataType="wstr"
                          length="1"
                          name="TIPO_PERSONA" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[MONEDA]"
                          dataType="wstr"
                          length="1"
                          name="MONEDA" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[SALDO_DEPOSITO]"
                          dataType="wstr"
                          length="16"
                          name="SALDO_DEPOSITO" />
                        <externalMetadataColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET].ExternalColumns[CANTIDAD_CUENTAS]"
                          dataType="numeric"
                          name="CANTIDAD_CUENTAS" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET]"
                      isErrorOut="true"
                      name="Salida de error de origen de ADO NET">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[FECHACORTE]"
                          dataType="dbTimeStamp"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[FECHACORTE]"
                          name="FECHACORTE" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[CODENVIO]"
                          dataType="wstr"
                          length="5"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[CODENVIO]"
                          name="CODENVIO" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[MODALIDAD]"
                          dataType="numeric"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[MODALIDAD]"
                          name="MODALIDAD"
                          precision="38"
                          scale="4" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[ESTADO]"
                          dataType="numeric"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[ESTADO]"
                          name="ESTADO"
                          precision="38"
                          scale="4" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[CLASIFICACION_SUMA_SALDOS]"
                          dataType="numeric"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[CLASIFICACION_SUMA_SALDOS]"
                          name="CLASIFICACION_SUMA_SALDOS"
                          precision="38"
                          scale="4" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[RANGO_TASA_PAGADA]"
                          dataType="wstr"
                          length="1"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[RANGO_TASA_PAGADA]"
                          name="RANGO_TASA_PAGADA" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[TIPO_PERSONA]"
                          dataType="wstr"
                          length="1"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[TIPO_PERSONA]"
                          name="TIPO_PERSONA" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[MONEDA]"
                          dataType="wstr"
                          length="1"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[MONEDA]"
                          name="MONEDA" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[SALDO_DEPOSITO]"
                          dataType="wstr"
                          length="16"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[SALDO_DEPOSITO]"
                          name="SALDO_DEPOSITO" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[CANTIDAD_CUENTAS]"
                          dataType="wstr"
                          length="40"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[CANTIDAD_CUENTAS]"
                          name="CANTIDAD_CUENTAS" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Archivo A\Data Flow Task.Paths[Salida de origen de ADO NET]"
                  endId="Package\Archivo A\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input]"
                  name="Salida de origen de ADO NET"
                  startId="Package\Archivo A\Data Flow Task\Origen de ADO NET.Outputs[Salida de origen de ADO NET]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Archivo A.PrecedenceConstraints[Restricción]"
          DTS:CreationName=""
          DTS:DTSID="{04239852-D49D-41AE-A433-2A8EB89200CE}"
          DTS:From="Package\Archivo A\Data Flow Task"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Restricción"
          DTS:To="Package\Archivo A\Correo Correcto" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Archivo A.PrecedenceConstraints[Restricción 1]"
          DTS:CreationName=""
          DTS:DTSID="{16BD02C8-B6B9-46D7-B1CE-2AB22600F848}"
          DTS:From="Package\Archivo A\Data Flow Task"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Restricción 1"
          DTS:To="Package\Archivo A\Correo Error"
          DTS:Value="1" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Archivo B"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Contenedor de secuencias"
      DTS:Disabled="True"
      DTS:DTSID="{46df5158-247e-4369-a613-59d165e18f67}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Archivo B">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Archivo B\Correo Correcto"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Tarea Ejecutar SQL"
          DTS:DTSID="{8cc0b47e-5497-43ff-93ba-2b904a1d87aa}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Correo Correcto"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="5">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="SqlStatementSource">"UPDATE asfi.control_ejecuciones_reportes_automaticos
        SET ESTADO_PROCESO = '0',  
            DETALLE_PROCESO = 'Proceso Finalizado Correcto - 001_RPT_Ahorrista_OP_7078.dtsx'
        WHERE ID_PROCESO = "+  (DT_WSTR, 25) @[$Project::idProceso] +";
USE MSDB; EXEC [dbo].[p_email_generico_reportes_ASFI]
    0,  -- TIPO 
    'DW: Reporte "+ @[User::nombreArchivoC]   +"',  -- ASUNTO 
    'Reporte de Ahorristas - Archivo C Generado Correctamente a corte "+ @[User::fechaFin] +"',  -- TITULO
    'El reporte de ahorristas ha sido generado exitosamente y se ha almacenado en la carpeta compartida.',  -- TEXTO
    '"+ @[User::correos] +"',  -- CORREOS
    '"+ @[User::rutaArchivo] +"';"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{0828E80A-351C-40CD-950C-99EBC714113F}"
              SQLTask:SqlStatementSource="UPDATE asfi.control_ejecuciones_reportes_automaticos&#xA;        SET ESTADO_PROCESO = '0',  &#xA;            DETALLE_PROCESO = 'Proceso Finalizado Correcto - 001_RPT_Ahorrista_OP_7078.dtsx'&#xA;        WHERE ID_PROCESO = 0;&#xA;USE MSDB; EXEC [dbo].[p_email_generico_reportes_ASFI]&#xA;    0,  -- TIPO &#xA;    'DW: Reporte TP20240229C.IBBGA',  -- ASUNTO &#xA;    'Reporte de Ahorristas - Archivo C Generado Correctamente a corte 20240229',  -- TITULO&#xA;    'El reporte de ahorristas ha sido generado exitosamente y se ha almacenado en la carpeta compartida.',  -- TEXTO&#xA;    'adquinteros@bg.com.bo;paulo.salazar@bg.com.bo',  -- CORREOS&#xA;    'C:\Users\andres.quinteros\Desktop\Infraestructura de data\Arquitectura de datos\ARQ - ArchivoC Ahorristas - OP-7078\Export\';" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Archivo B\Correo Error"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Tarea Ejecutar SQL"
          DTS:DTSID="{11fdb070-5734-4d15-8b98-05b200977ec9}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Correo Error"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="4">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="SqlStatementSource">"UPDATE asfi.control_ejecuciones_reportes_automaticos
        SET ESTADO_PROCESO = '2',  
            DETALLE_PROCESO = 'ERROR EN EL PAQUETE SSIS - 001_RPT_Ahorrista_OP_7078.dtsx'
        WHERE ID_PROCESO = "+  (DT_WSTR, 25) @[$Project::idProceso] +";
USE MSDB; 
EXEC [dbo].[p_email_generico_reportes_ASFI]
    1,  -- TIPO (para manejar el caso de error)
    'DW: Error en la Generación del Reporte "+  @[User::nombreArchivoC]  +"',  -- ASUNTO 
    'Error en la Generación del Reporte de Ahorristas - Archivo C',  -- TITULO
    'Ocurrió un error durante la generación del reporte de ahorristas. Por favor, contactar con el area de BI / Infraestructura de data.',  -- TEXTO
    '"+ @[User::correos] +"',  -- CORREOS
    '"+ @[User::rutaArchivo]  +"'   -- RUTA_ARCHIVO"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{0828E80A-351C-40CD-950C-99EBC714113F}"
              SQLTask:SqlStatementSource="UPDATE asfi.control_ejecuciones_reportes_automaticos&#xA;        SET ESTADO_PROCESO = '2',  &#xA;            DETALLE_PROCESO = 'ERROR EN EL PAQUETE SSIS - 001_RPT_Ahorrista_OP_7078.dtsx'&#xA;        WHERE ID_PROCESO = 0;&#xA;USE MSDB; &#xA;EXEC [dbo].[p_email_generico_reportes_ASFI]&#xA;    1,  -- TIPO (para manejar el caso de error)&#xA;    'DW: Error en la Generación del Reporte TP20240229C.IBBGA',  -- ASUNTO &#xA;    'Error en la Generación del Reporte de Ahorristas - Archivo C',  -- TITULO&#xA;    'Ocurrió un error durante la generación del reporte de ahorristas. Por favor, contactar con el area de BI / Infraestructura de data.',  -- TEXTO&#xA;    'adquinteros@bg.com.bo;paulo.salazar@bg.com.bo',  -- CORREOS&#xA;    'C:\Users\andres.quinteros\Desktop\Infraestructura de data\Arquitectura de datos\ARQ - ArchivoC Ahorristas - OP-7078\Export\'   -- RUTA_ARCHIVO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Archivo B\Data Flow Task"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Data Flow Task"
          DTS:DTSID="{1ea86c7b-0969-4c54-9e21-725dc2d8e6d1}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Data Flow Task"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="[Ahorristias_Archivo_C].[SqlCommand]">"WITH BASE AS ( 
   
SELECT  --La tabla BASE muestra el resultado de la consulta antes de hacer el pivoteo de sexo 1604
      SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
     , NVL(CC.TIPO_PERSONA,3) AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , NULL AS SEXO 
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM( ROUND(SD.SALDO_AJUSTADO * MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
    --INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST  AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0     
    WHERE SD.FECHA = to_Date('"+@[User::fechaFin]+"','yyyymmdd') AND (CC.TIPO_PERSONA &lt;&gt; 3 OR CC.TIPO_PERSONA IS NULL)
    AND SD.SALDO_AJUSTADO &lt;&gt; 0 --AND sh.jts_oid NOT IN (1756079,1757256,1759620)
    --AND SUBSTR(TO_CHAR(SH.C1730),0,5) IN (
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA
    
    
    
UNION
SELECT 
   SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
    , CC.TIPO_PERSONA AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , nvl(replace(PF.SEXO,' ',''),'M')--AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO*MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
--    INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0 20-06-2024 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0
    LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('"+@[User::fechaFin]+"','yyyymmdd') AND CC.TIPO_PERSONA = 3
    AND SD.SALDO_AJUSTADO &lt;&gt; 0
--    AND SUBSTR(TO_CHAR(SH.C1730),0,5) IN (  --20-06-2004
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA, nvl(replace(PF.SEXO,' ',''),'M')    
    
    )
    , 
AUX AS (

    SELECT  -- esta tabla es replica de Base, solo para hacer el pivoteo en la ultima parte
    SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
     , NVL(CC.TIPO_PERSONA,3) AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , NULL AS SEXO --AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO * MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
--    INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST  AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    --LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0
    --LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('"+@[User::fechaFin]+"','yyyymmdd') AND (CC.TIPO_PERSONA &lt;&gt; 3 OR CC.TIPO_PERSONA IS NULL)
    AND SD.SALDO_AJUSTADO &lt;&gt; 0 --AND sh.jts_oid NOT IN (1756079,1757256,1759620)
   AND  SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA
UNION
SELECT 
    SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
    , CC.TIPO_PERSONA AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , nvl(replace(PF.SEXO,' ',''),'M') --AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO*MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0 
    LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE = CP.CODIGOCLIENTE AND CC.TZ_LOCK = 0
    LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('"+@[User::fechaFin]+"','yyyymmdd') AND CC.TIPO_PERSONA = 3
    AND SD.SALDO_AJUSTADO &lt;&gt; 0
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA, nvl(replace(PF.SEXO,' ',''),'M')    

    )
 SELECT 
    TO_CHAR(BASE.FechaCorte,'YYYY-MM-DD') FechaCorte,
    'IBBGA' AS Banco,
    TRIM(TO_CHAR( BASE.CodigoTipoPersona , '999999999999')) AS CodigoTipoPersona,
    TRIM(TO_CHAR( CASE BASE.CodigoTipoPersona
        WHEN 3 THEN MAX(FF.NumeroDepositantesTotal) + MAX(MM.NumeroDepositantesTotal) 
        ELSE SUM(DISTINCT(BASE.NumeroDepositantesTotal))
    END , '999999999999')) AS NumeroDepositantesTotal,
    NVL(MAX(MM.NumeroDepositantesTotal), '') AS DepositantesVarones,  
    NVL(MAX(FF.NumeroDepositantesTotal), '') AS DepositantesMujeres,
    SUM(DISTINCT(BASE.NumeroCuentas)) AS NumeroCuentas,
    TRIM(TO_CHAR(SUM(DISTINCT(BASE.MontoSaldo)), '999999999999.00')) AS MontoSaldo
FROM BASE 
LEFT JOIN AUX FF ON FF.SEXO='F' AND FF.FechaCorte = BASE.FechaCorte AND FF.CodigoTipoPersona = BASE.CodigoTipoPersona
LEFT JOIN AUX MM ON MM.SEXO='M' AND MM.CodigoTipoPersona IN (3) AND MM.FechaCorte = BASE.FechaCorte AND MM.CodigoTipoPersona = BASE.CodigoTipoPersona
GROUP BY BASE.FechaCorte, BASE.CodEnvio, BASE.CodigoTipoPersona"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consume datos de SQL Server, OLE DB, ODBC u Oracle mediante el correspondiente proveedor de datos de .NET Framework. Se usa una instrucción Transact-SQL para definir el conjunto de resultados. Por ejemplo, se extraen datos de SQL Server con el proveedor de datos de .NET Framework para SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; Todos los derechos reservados; http://www.microsoft.com/sql/support;4"
                  description="Consume datos de SQL Server, OLE DB, ODBC u Oracle mediante el correspondiente proveedor de datos de .NET Framework. Se usa una instrucción Transact-SQL para definir el conjunto de resultados. Por ejemplo, se extraen datos de SQL Server con el proveedor de datos de .NET Framework para SQL Server."
                  name="Ahorristias_Archivo_C"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Especifica la instrucción SQL utilizada por el componente para extraer datos."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH BASE AS ( 
   
SELECT  --La tabla BASE muestra el resultado de la consulta antes de hacer el pivoteo de sexo 1604
      SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
     , NVL(CC.TIPO_PERSONA,3) AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , NULL AS SEXO 
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM( ROUND(SD.SALDO_AJUSTADO * MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
    --INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST  AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0     
    WHERE SD.FECHA = to_Date('20240229','yyyymmdd') AND (CC.TIPO_PERSONA &lt;&gt; 3 OR CC.TIPO_PERSONA IS NULL)
    AND SD.SALDO_AJUSTADO &lt;&gt; 0 --AND sh.jts_oid NOT IN (1756079,1757256,1759620)
    --AND SUBSTR(TO_CHAR(SH.C1730),0,5) IN (
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA
    
    
    
UNION
SELECT 
   SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
    , CC.TIPO_PERSONA AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , nvl(replace(PF.SEXO,' ',''),'M')--AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO*MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
--    INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0 20-06-2024 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0
    LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('20240229','yyyymmdd') AND CC.TIPO_PERSONA = 3
    AND SD.SALDO_AJUSTADO &lt;&gt; 0
--    AND SUBSTR(TO_CHAR(SH.C1730),0,5) IN (  --20-06-2004
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA, nvl(replace(PF.SEXO,' ',''),'M')    
    
    )
    , 
AUX AS (

    SELECT  -- esta tabla es replica de Base, solo para hacer el pivoteo en la ultima parte
    SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
     , NVL(CC.TIPO_PERSONA,3) AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , NULL AS SEXO --AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO * MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
--    INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST  AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    --LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0
    --LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('20240229','yyyymmdd') AND (CC.TIPO_PERSONA &lt;&gt; 3 OR CC.TIPO_PERSONA IS NULL)
    AND SD.SALDO_AJUSTADO &lt;&gt; 0 --AND sh.jts_oid NOT IN (1756079,1757256,1759620)
   AND  SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA
UNION
SELECT 
    SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
    , CC.TIPO_PERSONA AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , nvl(replace(PF.SEXO,' ',''),'M') --AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO*MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0 
    LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE = CP.CODIGOCLIENTE AND CC.TZ_LOCK = 0
    LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('20240229','yyyymmdd') AND CC.TIPO_PERSONA = 3
    AND SD.SALDO_AJUSTADO &lt;&gt; 0
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA, nvl(replace(PF.SEXO,' ',''),'M')    

    )
 SELECT 
    TO_CHAR(BASE.FechaCorte,'YYYY-MM-DD') FechaCorte,
    'IBBGA' AS Banco,
    TRIM(TO_CHAR( BASE.CodigoTipoPersona , '999999999999')) AS CodigoTipoPersona,
    TRIM(TO_CHAR( CASE BASE.CodigoTipoPersona
        WHEN 3 THEN MAX(FF.NumeroDepositantesTotal) + MAX(MM.NumeroDepositantesTotal) 
        ELSE SUM(DISTINCT(BASE.NumeroDepositantesTotal))
    END , '999999999999')) AS NumeroDepositantesTotal,
    NVL(MAX(MM.NumeroDepositantesTotal), '') AS DepositantesVarones,  
    NVL(MAX(FF.NumeroDepositantesTotal), '') AS DepositantesMujeres,
    SUM(DISTINCT(BASE.NumeroCuentas)) AS NumeroCuentas,
    TRIM(TO_CHAR(SUM(DISTINCT(BASE.MontoSaldo)), '999999999999.00')) AS MontoSaldo
FROM BASE 
LEFT JOIN AUX FF ON FF.SEXO='F' AND FF.FechaCorte = BASE.FechaCorte AND FF.CodigoTipoPersona = BASE.CodigoTipoPersona
LEFT JOIN AUX MM ON MM.SEXO='M' AND MM.CodigoTipoPersona IN (3) AND MM.FechaCorte = BASE.FechaCorte AND MM.CodigoTipoPersona = BASE.CodigoTipoPersona
GROUP BY BASE.FechaCorte, BASE.CodEnvio, BASE.CodigoTipoPersona</property>
                    <property
                      dataType="System.Int32"
                      description="Número de segundos antes de que se agote el tiempo de espera de un comando. Un valor de 0 indica un tiempo de espera infinito."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indica si se debe permitir que columnas externas que no sean de cadenas se conviertan implícitamente en cadenas en las columnas de salida."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="Nombre de la tabla de la base de datos de origen."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Especificar el modo de recuperar información de columnas externas"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Connections[IDbConnection]"
                      connectionManagerID="{413BF411-79F6-4190-B17F-9BDFA39EBB0B}:external"
                      connectionManagerRefId="Project.ConnectionManagers[LCBGDB2.dmart_app]"
                      description="Administrador de conexiones administrado"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET]"
                      name="Salida de origen de ADO NET">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[FECHACORTE]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[FECHACORTE]"
                          length="10"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[FECHACORTE]"
                          name="FECHACORTE"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[BANCO]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[BANCO]"
                          length="5"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[BANCO]"
                          name="BANCO"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[CODIGOTIPOPERSONA]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[CODIGOTIPOPERSONA]"
                          length="13"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[CODIGOTIPOPERSONA]"
                          name="CODIGOTIPOPERSONA"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMERODEPOSITANTESTOTAL]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[NUMERODEPOSITANTESTOTAL]"
                          length="13"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMERODEPOSITANTESTOTAL]"
                          name="NUMERODEPOSITANTESTOTAL"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESVARONES]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[DEPOSITANTESVARONES]"
                          length="40"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESVARONES]"
                          name="DEPOSITANTESVARONES"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESMUJERES]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[DEPOSITANTESMUJERES]"
                          length="40"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESMUJERES]"
                          name="DEPOSITANTESMUJERES"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMEROCUENTAS]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[NUMEROCUENTAS]"
                          length="40"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMEROCUENTAS]"
                          name="NUMEROCUENTAS"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[MONTOSALDO]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[MONTOSALDO]"
                          length="16"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[MONTOSALDO]"
                          name="MONTOSALDO"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[FECHACORTE]"
                          dataType="wstr"
                          length="10"
                          name="FECHACORTE" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[BANCO]"
                          dataType="wstr"
                          length="5"
                          name="BANCO" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[CODIGOTIPOPERSONA]"
                          dataType="wstr"
                          length="13"
                          name="CODIGOTIPOPERSONA" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[NUMERODEPOSITANTESTOTAL]"
                          dataType="wstr"
                          length="13"
                          name="NUMERODEPOSITANTESTOTAL" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[DEPOSITANTESVARONES]"
                          dataType="numeric"
                          name="DEPOSITANTESVARONES" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[DEPOSITANTESMUJERES]"
                          dataType="numeric"
                          name="DEPOSITANTESMUJERES" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[NUMEROCUENTAS]"
                          dataType="numeric"
                          name="NUMEROCUENTAS" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[MONTOSALDO]"
                          dataType="wstr"
                          length="16"
                          name="MONTOSALDO" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET]"
                      isErrorOut="true"
                      name="Salida de error de origen de ADO NET">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[FECHACORTE]"
                          dataType="wstr"
                          length="10"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[FECHACORTE]"
                          name="FECHACORTE" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[BANCO]"
                          dataType="wstr"
                          length="5"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[BANCO]"
                          name="BANCO" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[CODIGOTIPOPERSONA]"
                          dataType="wstr"
                          length="13"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[CODIGOTIPOPERSONA]"
                          name="CODIGOTIPOPERSONA" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[NUMERODEPOSITANTESTOTAL]"
                          dataType="wstr"
                          length="13"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[NUMERODEPOSITANTESTOTAL]"
                          name="NUMERODEPOSITANTESTOTAL" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[DEPOSITANTESVARONES]"
                          dataType="wstr"
                          length="40"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[DEPOSITANTESVARONES]"
                          name="DEPOSITANTESVARONES" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[DEPOSITANTESMUJERES]"
                          dataType="wstr"
                          length="40"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[DEPOSITANTESMUJERES]"
                          name="DEPOSITANTESMUJERES" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[NUMEROCUENTAS]"
                          dataType="wstr"
                          length="40"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[NUMEROCUENTAS]"
                          name="NUMEROCUENTAS" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[MONTOSALDO]"
                          dataType="wstr"
                          length="16"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[MONTOSALDO]"
                          name="MONTOSALDO" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Archivo B\Data Flow Task\Flat File Destination"
                  componentClassID="Microsoft.FlatFileDestination"
                  contactInfo="Flat File Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                  description="Flat File Destination"
                  localeId="16394"
                  name="Flat File Destination"
                  version="1">
                  <properties>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether the data will overwrite or append to the destination file."
                      name="Overwrite">true</property>
                    <property
                      dataType="System.Null"
                      description="Specifies the text to write to the destination file before any data is written."
                      expressionType="Notify"
                      name="Header" />
                    <property
                      dataType="System.Boolean"
                      description="When text qualifier is enabled, specifies whether the text qualifier in the data written to the destination file will be escaped or not."
                      name="EscapeQualifier">false</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Archivo B\Data Flow Task\Flat File Destination.Connections[FlatFileConnection]"
                      connectionManagerID="Package.ConnectionManagers[ArchivoC]"
                      connectionManagerRefId="Package.ConnectionManagers[ArchivoC]"
                      name="FlatFileConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input]"
                      hasSideEffects="true"
                      name="Flat File Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[FECHACORTE]"
                          cachedDataType="wstr"
                          cachedLength="10"
                          cachedName="FECHACORTE"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[FECHACORTE]"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[FECHACORTE]" />
                        <inputColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[BANCO]"
                          cachedDataType="wstr"
                          cachedLength="5"
                          cachedName="BANCO"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[BANCO]"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[BANCO]" />
                        <inputColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[CODIGOTIPOPERSONA]"
                          cachedDataType="wstr"
                          cachedLength="13"
                          cachedName="CODIGOTIPOPERSONA"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CODIGOTIPOPERSONA]"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[CODIGOTIPOPERSONA]" />
                        <inputColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[NUMERODEPOSITANTESTOTAL]"
                          cachedDataType="wstr"
                          cachedLength="13"
                          cachedName="NUMERODEPOSITANTESTOTAL"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NUMERODEPOSITANTESTOTAL]"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMERODEPOSITANTESTOTAL]" />
                        <inputColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[DEPOSITANTESVARONES]"
                          cachedDataType="wstr"
                          cachedLength="40"
                          cachedName="DEPOSITANTESVARONES"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[DEPOSITANTESVARONES]"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESVARONES]" />
                        <inputColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[DEPOSITANTESMUJERES]"
                          cachedDataType="wstr"
                          cachedLength="40"
                          cachedName="DEPOSITANTESMUJERES"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[DEPOSITANTESMUJERES]"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESMUJERES]" />
                        <inputColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[NUMEROCUENTAS]"
                          cachedDataType="wstr"
                          cachedLength="40"
                          cachedName="NUMEROCUENTAS"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NUMEROCUENTAS]"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMEROCUENTAS]" />
                        <inputColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[MONTOSALDO]"
                          cachedDataType="wstr"
                          cachedLength="16"
                          cachedName="MONTOSALDO"
                          externalMetadataColumnId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[MONTOSALDO]"
                          lineageId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[MONTOSALDO]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[FECHACORTE]"
                          dataType="wstr"
                          length="10"
                          name="FECHACORTE" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[BANCO]"
                          dataType="wstr"
                          length="5"
                          name="BANCO" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CODIGOTIPOPERSONA]"
                          dataType="numeric"
                          name="CODIGOTIPOPERSONA"
                          precision="38"
                          scale="4" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NUMERODEPOSITANTESTOTAL]"
                          dataType="numeric"
                          name="NUMERODEPOSITANTESTOTAL"
                          precision="38"
                          scale="4" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[DEPOSITANTESVARONES]"
                          dataType="wstr"
                          length="40"
                          name="DEPOSITANTESVARONES" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[DEPOSITANTESMUJERES]"
                          dataType="wstr"
                          length="40"
                          name="DEPOSITANTESMUJERES" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NUMEROCUENTAS]"
                          dataType="wstr"
                          length="40"
                          name="NUMEROCUENTAS" />
                        <externalMetadataColumn
                          refId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[MONTOSALDO]"
                          dataType="wstr"
                          length="16"
                          name="MONTOSALDO" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Archivo B\Data Flow Task.Paths[Salida de origen de ADO NET]"
                  endId="Package\Archivo B\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input]"
                  name="Salida de origen de ADO NET"
                  startId="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Archivo B.PrecedenceConstraints[Restricción]"
          DTS:CreationName=""
          DTS:DTSID="{249221A1-AE19-4B7A-AC94-6C0D3DF936F8}"
          DTS:From="Package\Archivo B\Data Flow Task"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Restricción"
          DTS:To="Package\Archivo B\Correo Correcto" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Archivo B.PrecedenceConstraints[Restricción 1]"
          DTS:CreationName=""
          DTS:DTSID="{CF32CD7C-DB55-47D6-B960-8BACC4D577CF}"
          DTS:From="Package\Archivo B\Data Flow Task"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Restricción 1"
          DTS:To="Package\Archivo B\Correo Error" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Archivo C"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Contenedor de secuencias"
      DTS:DTSID="{FD6F5372-76A8-475D-BA17-8F6D60B9FC5E}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Archivo C">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Archivo C\Correo Correcto"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Tarea Ejecutar SQL"
          DTS:DTSID="{52CF8672-B930-4191-9F02-5690EDC46496}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Correo Correcto"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="SqlStatementSource">"UPDATE asfi.control_ejecuciones_reportes_automaticos
        SET ESTADO_PROCESO = '0',  
            DETALLE_PROCESO = 'Proceso Finalizado Correcto - 001_RPT_Ahorrista_OP_7078.dtsx',
			PARAMETROS = PARAMETROS + '|NOM_ARCHIVO_C="+ @[User::nombreArchivoC] +"'
        WHERE ID_PROCESO = "+  (DT_WSTR, 25) @[$Project::idProceso] +";

USE MSDB; EXEC [dbo].[p_email_generico_reportes_ASFI]
    0,  -- TIPO 
    'DW: Reporte "+ @[User::nombreArchivoC]   +"',  -- ASUNTO 
    'Reporte de Ahorristas - Archivo C Generado Correctamente a corte "+ @[User::fechaFin] +"',  -- TITULO
    'El reporte de ahorristas ha sido generado exitosamente y se ha almacenado en la carpeta compartida.',  -- TEXTO
    '"+ @[User::correos] +"',  -- CORREOS
    '"+ @[User::rutaArchivo] +"';"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{0828E80A-351C-40CD-950C-99EBC714113F}"
              SQLTask:SqlStatementSource="UPDATE asfi.control_ejecuciones_reportes_automaticos&#xA;        SET ESTADO_PROCESO = '0',  &#xA;            DETALLE_PROCESO = 'Proceso Finalizado Correcto - 001_RPT_Ahorrista_OP_7078.dtsx',&#xA;&#x9;&#x9;&#x9;PARAMETROS = PARAMETROS + '|NOM_ARCHIVO_C=TP20240229C.IBBGA'&#xA;        WHERE ID_PROCESO = 0;&#xA;&#xA;USE MSDB; EXEC [dbo].[p_email_generico_reportes_ASFI]&#xA;    0,  -- TIPO &#xA;    'DW: Reporte TP20240229C.IBBGA',  -- ASUNTO &#xA;    'Reporte de Ahorristas - Archivo C Generado Correctamente a corte 20240229',  -- TITULO&#xA;    'El reporte de ahorristas ha sido generado exitosamente y se ha almacenado en la carpeta compartida.',  -- TEXTO&#xA;    'adquinteros@bg.com.bo;paulo.salazar@bg.com.bo',  -- CORREOS&#xA;    'C:\Users\andres.quinteros\Desktop\Infraestructura de data\Arquitectura de datos\ARQ - ArchivoC Ahorristas - OP-7078\Export\';" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Archivo C\Correo Error"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Tarea Ejecutar SQL"
          DTS:DTSID="{E2A3FB9A-7E24-47FF-A063-7516C431833D}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Correo Error"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="SqlStatementSource">"UPDATE asfi.control_ejecuciones_reportes_automaticos
        SET ESTADO_PROCESO = '2',  
            DETALLE_PROCESO = 'ERROR EN EL PAQUETE SSIS - 001_RPT_Ahorrista_OP_7078.dtsx'
        WHERE ID_PROCESO = "+  (DT_WSTR, 25) @[$Project::idProceso] +";
USE MSDB; 
EXEC [dbo].[p_email_generico_reportes_ASFI]
    1,  -- TIPO (para manejar el caso de error)
    'DW: Error en la Generación del Reporte "+  @[User::nombreArchivoC]  +"',  -- ASUNTO 
    'Error en la Generación del Reporte de Ahorristas - Archivo C',  -- TITULO
    'Ocurrió un error durante la generación del reporte de ahorristas. Por favor, contactar con el area de BI / Infraestructura de data.',  -- TEXTO
    '"+ @[User::correos] +"',  -- CORREOS
    '"+ @[User::rutaArchivo]  +"'   -- RUTA_ARCHIVO"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{0828E80A-351C-40CD-950C-99EBC714113F}"
              SQLTask:SqlStatementSource="UPDATE asfi.control_ejecuciones_reportes_automaticos&#xA;        SET ESTADO_PROCESO = '2',  &#xA;            DETALLE_PROCESO = 'ERROR EN EL PAQUETE SSIS - 001_RPT_Ahorrista_OP_7078.dtsx'&#xA;        WHERE ID_PROCESO = 0;&#xA;USE MSDB; &#xA;EXEC [dbo].[p_email_generico_reportes_ASFI]&#xA;    1,  -- TIPO (para manejar el caso de error)&#xA;    'DW: Error en la Generación del Reporte TP20240229C.IBBGA',  -- ASUNTO &#xA;    'Error en la Generación del Reporte de Ahorristas - Archivo C',  -- TITULO&#xA;    'Ocurrió un error durante la generación del reporte de ahorristas. Por favor, contactar con el area de BI / Infraestructura de data.',  -- TEXTO&#xA;    'adquinteros@bg.com.bo;paulo.salazar@bg.com.bo',  -- CORREOS&#xA;    'C:\Users\andres.quinteros\Desktop\Infraestructura de data\Arquitectura de datos\ARQ - ArchivoC Ahorristas - OP-7078\Export\'   -- RUTA_ARCHIVO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Archivo C\Data Flow Task"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Data Flow Task"
          DTS:DTSID="{88CAC2C8-E735-496E-96BA-8B4CB881C948}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Data Flow Task"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="[Ahorristias_Archivo_C].[SqlCommand]">"WITH BASE AS ( 
   
SELECT  --La tabla BASE muestra el resultado de la consulta antes de hacer el pivoteo de sexo 1604
      SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
     , NVL(CC.TIPO_PERSONA,3) AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , NULL AS SEXO 
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM( ROUND(SD.SALDO_AJUSTADO * MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
    --INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST  AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0     
    WHERE SD.FECHA = to_Date('"+@[User::fechaFin]+"','yyyymmdd') AND (CC.TIPO_PERSONA &lt;&gt; 3 OR CC.TIPO_PERSONA IS NULL)
    AND SD.SALDO_AJUSTADO &lt;&gt; 0 --AND sh.jts_oid NOT IN (1756079,1757256,1759620)
    --AND SUBSTR(TO_CHAR(SH.C1730),0,5) IN (
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA
    
    
    
UNION
SELECT 
   SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
    , CC.TIPO_PERSONA AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , nvl(replace(PF.SEXO,' ',''),'M')--AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO*MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
--    INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0 20-06-2024 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0
    LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('"+@[User::fechaFin]+"','yyyymmdd') AND CC.TIPO_PERSONA = 3
    AND SD.SALDO_AJUSTADO &lt;&gt; 0
--    AND SUBSTR(TO_CHAR(SH.C1730),0,5) IN (  --20-06-2004
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA, nvl(replace(PF.SEXO,' ',''),'M')    
    
    )
    , 
AUX AS (

    SELECT  -- esta tabla es replica de Base, solo para hacer el pivoteo en la ultima parte
    SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
     , NVL(CC.TIPO_PERSONA,3) AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , NULL AS SEXO --AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO * MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
--    INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST  AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    --LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0
    --LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('"+@[User::fechaFin]+"','yyyymmdd') AND (CC.TIPO_PERSONA &lt;&gt; 3 OR CC.TIPO_PERSONA IS NULL)
    AND SD.SALDO_AJUSTADO &lt;&gt; 0 --AND sh.jts_oid NOT IN (1756079,1757256,1759620)
   AND  SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA
UNION
SELECT 
    SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
    , CC.TIPO_PERSONA AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , nvl(replace(PF.SEXO,' ',''),'M') --AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO*MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0 
    LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE = CP.CODIGOCLIENTE AND CC.TZ_LOCK = 0
    LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('"+@[User::fechaFin]+"','yyyymmdd') AND CC.TIPO_PERSONA = 3
    AND SD.SALDO_AJUSTADO &lt;&gt; 0
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA, nvl(replace(PF.SEXO,' ',''),'M')    

    )
 SELECT 
    TO_CHAR(BASE.FechaCorte,'YYYY-MM-DD') FechaCorte,
    'IBBGA' AS Banco,
    TRIM(TO_CHAR( BASE.CodigoTipoPersona , '999999999999')) AS CodigoTipoPersona,
    TRIM(TO_CHAR( CASE BASE.CodigoTipoPersona
        WHEN 3 THEN MAX(FF.NumeroDepositantesTotal) + MAX(MM.NumeroDepositantesTotal) 
        ELSE SUM(DISTINCT(BASE.NumeroDepositantesTotal))
    END , '999999999999')) AS NumeroDepositantesTotal,
    NVL(MAX(MM.NumeroDepositantesTotal), '') AS DepositantesVarones,  
    NVL(MAX(FF.NumeroDepositantesTotal), '') AS DepositantesMujeres,
    SUM(DISTINCT(BASE.NumeroCuentas)) AS NumeroCuentas,
    TRIM(TO_CHAR(SUM(DISTINCT(BASE.MontoSaldo)), '999999999999.00')) AS MontoSaldo
FROM BASE 
LEFT JOIN AUX FF ON FF.SEXO='F' AND FF.FechaCorte = BASE.FechaCorte AND FF.CodigoTipoPersona = BASE.CodigoTipoPersona
LEFT JOIN AUX MM ON MM.SEXO='M' AND MM.CodigoTipoPersona IN (3) AND MM.FechaCorte = BASE.FechaCorte AND MM.CodigoTipoPersona = BASE.CodigoTipoPersona
GROUP BY BASE.FechaCorte, BASE.CodEnvio, BASE.CodigoTipoPersona"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consume datos de SQL Server, OLE DB, ODBC u Oracle mediante el correspondiente proveedor de datos de .NET Framework. Se usa una instrucción Transact-SQL para definir el conjunto de resultados. Por ejemplo, se extraen datos de SQL Server con el proveedor de datos de .NET Framework para SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; Todos los derechos reservados; http://www.microsoft.com/sql/support;4"
                  description="Consume datos de SQL Server, OLE DB, ODBC u Oracle mediante el correspondiente proveedor de datos de .NET Framework. Se usa una instrucción Transact-SQL para definir el conjunto de resultados. Por ejemplo, se extraen datos de SQL Server con el proveedor de datos de .NET Framework para SQL Server."
                  name="Ahorristias_Archivo_C"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Especifica la instrucción SQL utilizada por el componente para extraer datos."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH BASE AS ( 
   
SELECT  --La tabla BASE muestra el resultado de la consulta antes de hacer el pivoteo de sexo 1604
      SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
     , NVL(CC.TIPO_PERSONA,3) AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , NULL AS SEXO 
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM( ROUND(SD.SALDO_AJUSTADO * MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
    --INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST  AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0     
    WHERE SD.FECHA = to_Date('20240229','yyyymmdd') AND (CC.TIPO_PERSONA &lt;&gt; 3 OR CC.TIPO_PERSONA IS NULL)
    AND SD.SALDO_AJUSTADO &lt;&gt; 0 --AND sh.jts_oid NOT IN (1756079,1757256,1759620)
    --AND SUBSTR(TO_CHAR(SH.C1730),0,5) IN (
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA
    
    
    
UNION
SELECT 
   SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
    , CC.TIPO_PERSONA AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , nvl(replace(PF.SEXO,' ',''),'M')--AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO*MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
--    INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0 20-06-2024 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0
    LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('20240229','yyyymmdd') AND CC.TIPO_PERSONA = 3
    AND SD.SALDO_AJUSTADO &lt;&gt; 0
--    AND SUBSTR(TO_CHAR(SH.C1730),0,5) IN (  --20-06-2004
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA, nvl(replace(PF.SEXO,' ',''),'M')    
    
    )
    , 
AUX AS (

    SELECT  -- esta tabla es replica de Base, solo para hacer el pivoteo en la ultima parte
    SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
     , NVL(CC.TIPO_PERSONA,3) AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , NULL AS SEXO --AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO * MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD
--    INNER JOIN BG_SALDOS_HIST SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.FECHA = SH.FECHA_HIST  AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0
    --LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE =  SH.C1803 AND CC.TZ_LOCK = 0
    --LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('20240229','yyyymmdd') AND (CC.TIPO_PERSONA &lt;&gt; 3 OR CC.TIPO_PERSONA IS NULL)
    AND SD.SALDO_AJUSTADO &lt;&gt; 0 --AND sh.jts_oid NOT IN (1756079,1757256,1759620)
   AND  SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA
UNION
SELECT 
    SD.FECHA AS FechaCorte
    , 'IBBGA' AS CodEnvio
    , CC.TIPO_PERSONA AS CodigoTipoPersona
    , COUNT(CC.CODIGOCLIENTE) AS NumeroDepositantesTotal
    , nvl(replace(PF.SEXO,' ',''),'M') --AUX
    , COUNT(SH.CUENTA) AS NumeroCuentas
    , SUM(round(SD.SALDO_AJUSTADO*MO.TIPO_CAMBIO_BCU,2)) AS MontoSaldo
    FROM GRL_SALDOS_DIARIOS SD 
    INNER JOIN SALDOS SH ON SH.JTS_OID = SD.SALDOS_JTS_OID AND SD.TZ_LOCK = 0 AND SH.TZ_LOCK = 0
    INNER JOIN HISTORICOTIPOSCAMBIO MO ON MO.MONEDA = SH.MONEDA AND MO.FECHA_COTIZACION = SD.FECHA AND MO.TZ_LOCK = 0 
    LEFT JOIN CLI_CLIENTEPERSONA CP ON CP.CODIGOCLIENTE = SH.C1803 AND TITULARIDAD = 'T' AND CP.TZ_LOCK = 0
    LEFT JOIN CLI_CLIENTES CC ON CC.CODIGOCLIENTE = CP.CODIGOCLIENTE AND CC.TZ_LOCK = 0
    LEFT JOIN CLI_PERSONASFISICAS PF ON CP.NUMEROPERSONA = PF.NUMEROPERSONAFISICA AND PF.TZ_LOCK = 0
    WHERE SD.FECHA = to_Date('20240229','yyyymmdd') AND CC.TIPO_PERSONA = 3
    AND SD.SALDO_AJUSTADO &lt;&gt; 0
    AND SUBSTR(TO_CHAR(SD.RUBROCONTABLE),0,5) IN (
        '21101','21102','21103','21402',
        '22101','22102','22402','21202',
        '21303','21504','28301','28502',
        '21406','22403','21403','21304',
        '21505','28302','28503','21408',        
        '23103','23507','21305','21506',
        '28303','28504','28404','23104',
        '23508','21306','21507','28304',
        '28505','28405','28101','28201',
        '21307','21508','28305','28506',
        '28406','28102','28202','21308',
        '23509','28306','28507','28408',        
        '28103','28403','21501','23510',
        '28307','28508','28402','21301',
        '21502','23511','28308','21404',        
        '21201','21302','21503','23512',
        '28501','21405')
    GROUP BY SD.FECHA, CC.TIPO_PERSONA, nvl(replace(PF.SEXO,' ',''),'M')    

    )
 SELECT 
    TO_CHAR(BASE.FechaCorte,'YYYY-MM-DD') FechaCorte,
    'IBBGA' AS Banco,
    TRIM(TO_CHAR( BASE.CodigoTipoPersona , '999999999999')) AS CodigoTipoPersona,
    TRIM(TO_CHAR( CASE BASE.CodigoTipoPersona
        WHEN 3 THEN MAX(FF.NumeroDepositantesTotal) + MAX(MM.NumeroDepositantesTotal) 
        ELSE SUM(DISTINCT(BASE.NumeroDepositantesTotal))
    END , '999999999999')) AS NumeroDepositantesTotal,
    NVL(MAX(MM.NumeroDepositantesTotal), '') AS DepositantesVarones,  
    NVL(MAX(FF.NumeroDepositantesTotal), '') AS DepositantesMujeres,
    SUM(DISTINCT(BASE.NumeroCuentas)) AS NumeroCuentas,
    TRIM(TO_CHAR(SUM(DISTINCT(BASE.MontoSaldo)), '999999999999.00')) AS MontoSaldo
FROM BASE 
LEFT JOIN AUX FF ON FF.SEXO='F' AND FF.FechaCorte = BASE.FechaCorte AND FF.CodigoTipoPersona = BASE.CodigoTipoPersona
LEFT JOIN AUX MM ON MM.SEXO='M' AND MM.CodigoTipoPersona IN (3) AND MM.FechaCorte = BASE.FechaCorte AND MM.CodigoTipoPersona = BASE.CodigoTipoPersona
GROUP BY BASE.FechaCorte, BASE.CodEnvio, BASE.CodigoTipoPersona</property>
                    <property
                      dataType="System.Int32"
                      description="Número de segundos antes de que se agote el tiempo de espera de un comando. Un valor de 0 indica un tiempo de espera infinito."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indica si se debe permitir que columnas externas que no sean de cadenas se conviertan implícitamente en cadenas en las columnas de salida."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="Nombre de la tabla de la base de datos de origen."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Especificar el modo de recuperar información de columnas externas"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Connections[IDbConnection]"
                      connectionManagerID="{413BF411-79F6-4190-B17F-9BDFA39EBB0B}:external"
                      connectionManagerRefId="Project.ConnectionManagers[LCBGDB2.dmart_app]"
                      description="Administrador de conexiones administrado"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET]"
                      name="Salida de origen de ADO NET">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[FECHACORTE]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[FECHACORTE]"
                          length="10"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[FECHACORTE]"
                          name="FECHACORTE"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[BANCO]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[BANCO]"
                          length="5"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[BANCO]"
                          name="BANCO"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[CODIGOTIPOPERSONA]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[CODIGOTIPOPERSONA]"
                          length="13"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[CODIGOTIPOPERSONA]"
                          name="CODIGOTIPOPERSONA"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMERODEPOSITANTESTOTAL]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[NUMERODEPOSITANTESTOTAL]"
                          length="13"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMERODEPOSITANTESTOTAL]"
                          name="NUMERODEPOSITANTESTOTAL"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESVARONES]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[DEPOSITANTESVARONES]"
                          length="40"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESVARONES]"
                          name="DEPOSITANTESVARONES"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESMUJERES]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[DEPOSITANTESMUJERES]"
                          length="40"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESMUJERES]"
                          name="DEPOSITANTESMUJERES"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMEROCUENTAS]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[NUMEROCUENTAS]"
                          length="40"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMEROCUENTAS]"
                          name="NUMEROCUENTAS"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[MONTOSALDO]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversión"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[MONTOSALDO]"
                          length="16"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[MONTOSALDO]"
                          name="MONTOSALDO"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[FECHACORTE]"
                          dataType="wstr"
                          length="10"
                          name="FECHACORTE" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[BANCO]"
                          dataType="wstr"
                          length="5"
                          name="BANCO" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[CODIGOTIPOPERSONA]"
                          dataType="wstr"
                          length="13"
                          name="CODIGOTIPOPERSONA" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[NUMERODEPOSITANTESTOTAL]"
                          dataType="wstr"
                          length="13"
                          name="NUMERODEPOSITANTESTOTAL" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[DEPOSITANTESVARONES]"
                          dataType="numeric"
                          name="DEPOSITANTESVARONES" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[DEPOSITANTESMUJERES]"
                          dataType="numeric"
                          name="DEPOSITANTESMUJERES" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[NUMEROCUENTAS]"
                          dataType="numeric"
                          name="NUMEROCUENTAS" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].ExternalColumns[MONTOSALDO]"
                          dataType="wstr"
                          length="16"
                          name="MONTOSALDO" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET]"
                      isErrorOut="true"
                      name="Salida de error de origen de ADO NET">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[FECHACORTE]"
                          dataType="wstr"
                          length="10"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[FECHACORTE]"
                          name="FECHACORTE" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[BANCO]"
                          dataType="wstr"
                          length="5"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[BANCO]"
                          name="BANCO" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[CODIGOTIPOPERSONA]"
                          dataType="wstr"
                          length="13"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[CODIGOTIPOPERSONA]"
                          name="CODIGOTIPOPERSONA" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[NUMERODEPOSITANTESTOTAL]"
                          dataType="wstr"
                          length="13"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[NUMERODEPOSITANTESTOTAL]"
                          name="NUMERODEPOSITANTESTOTAL" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[DEPOSITANTESVARONES]"
                          dataType="wstr"
                          length="40"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[DEPOSITANTESVARONES]"
                          name="DEPOSITANTESVARONES" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[DEPOSITANTESMUJERES]"
                          dataType="wstr"
                          length="40"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[DEPOSITANTESMUJERES]"
                          name="DEPOSITANTESMUJERES" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[NUMEROCUENTAS]"
                          dataType="wstr"
                          length="40"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[NUMEROCUENTAS]"
                          name="NUMEROCUENTAS" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[MONTOSALDO]"
                          dataType="wstr"
                          length="16"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[MONTOSALDO]"
                          name="MONTOSALDO" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de error de origen de ADO NET].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Archivo C\Data Flow Task\Flat File Destination"
                  componentClassID="Microsoft.FlatFileDestination"
                  contactInfo="Flat File Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
                  description="Flat File Destination"
                  localeId="16394"
                  name="Flat File Destination"
                  version="1">
                  <properties>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether the data will overwrite or append to the destination file."
                      name="Overwrite">true</property>
                    <property
                      dataType="System.Null"
                      description="Specifies the text to write to the destination file before any data is written."
                      expressionType="Notify"
                      name="Header" />
                    <property
                      dataType="System.Boolean"
                      description="When text qualifier is enabled, specifies whether the text qualifier in the data written to the destination file will be escaped or not."
                      name="EscapeQualifier">false</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Archivo C\Data Flow Task\Flat File Destination.Connections[FlatFileConnection]"
                      connectionManagerID="Package.ConnectionManagers[ArchivoC]"
                      connectionManagerRefId="Package.ConnectionManagers[ArchivoC]"
                      name="FlatFileConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input]"
                      hasSideEffects="true"
                      name="Flat File Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[FECHACORTE]"
                          cachedDataType="wstr"
                          cachedLength="10"
                          cachedName="FECHACORTE"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[FECHACORTE]"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[FECHACORTE]" />
                        <inputColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[BANCO]"
                          cachedDataType="wstr"
                          cachedLength="5"
                          cachedName="BANCO"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[BANCO]"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[BANCO]" />
                        <inputColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[CODIGOTIPOPERSONA]"
                          cachedDataType="wstr"
                          cachedLength="13"
                          cachedName="CODIGOTIPOPERSONA"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CODIGOTIPOPERSONA]"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[CODIGOTIPOPERSONA]" />
                        <inputColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[NUMERODEPOSITANTESTOTAL]"
                          cachedDataType="wstr"
                          cachedLength="13"
                          cachedName="NUMERODEPOSITANTESTOTAL"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NUMERODEPOSITANTESTOTAL]"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMERODEPOSITANTESTOTAL]" />
                        <inputColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[DEPOSITANTESVARONES]"
                          cachedDataType="wstr"
                          cachedLength="40"
                          cachedName="DEPOSITANTESVARONES"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[DEPOSITANTESVARONES]"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESVARONES]" />
                        <inputColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[DEPOSITANTESMUJERES]"
                          cachedDataType="wstr"
                          cachedLength="40"
                          cachedName="DEPOSITANTESMUJERES"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[DEPOSITANTESMUJERES]"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[DEPOSITANTESMUJERES]" />
                        <inputColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[NUMEROCUENTAS]"
                          cachedDataType="wstr"
                          cachedLength="40"
                          cachedName="NUMEROCUENTAS"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NUMEROCUENTAS]"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[NUMEROCUENTAS]" />
                        <inputColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].Columns[MONTOSALDO]"
                          cachedDataType="wstr"
                          cachedLength="16"
                          cachedName="MONTOSALDO"
                          externalMetadataColumnId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[MONTOSALDO]"
                          lineageId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET].Columns[MONTOSALDO]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[FECHACORTE]"
                          dataType="wstr"
                          length="10"
                          name="FECHACORTE" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[BANCO]"
                          dataType="wstr"
                          length="5"
                          name="BANCO" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CODIGOTIPOPERSONA]"
                          dataType="numeric"
                          name="CODIGOTIPOPERSONA"
                          precision="38"
                          scale="4" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NUMERODEPOSITANTESTOTAL]"
                          dataType="numeric"
                          name="NUMERODEPOSITANTESTOTAL"
                          precision="38"
                          scale="4" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[DEPOSITANTESVARONES]"
                          dataType="wstr"
                          length="40"
                          name="DEPOSITANTESVARONES" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[DEPOSITANTESMUJERES]"
                          dataType="wstr"
                          length="40"
                          name="DEPOSITANTESMUJERES" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NUMEROCUENTAS]"
                          dataType="wstr"
                          length="40"
                          name="NUMEROCUENTAS" />
                        <externalMetadataColumn
                          refId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[MONTOSALDO]"
                          dataType="wstr"
                          length="16"
                          name="MONTOSALDO" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Archivo C\Data Flow Task.Paths[Salida de origen de ADO NET]"
                  endId="Package\Archivo C\Data Flow Task\Flat File Destination.Inputs[Flat File Destination Input]"
                  name="Salida de origen de ADO NET"
                  startId="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C.Outputs[Salida de origen de ADO NET]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Archivo C.PrecedenceConstraints[Restricción]"
          DTS:CreationName=""
          DTS:DTSID="{E47392D6-D727-4FA2-B899-C1FE4C01D209}"
          DTS:From="Package\Archivo C\Data Flow Task"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Restricción"
          DTS:To="Package\Archivo C\Correo Correcto" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Archivo C.PrecedenceConstraints[Restricción 1]"
          DTS:CreationName=""
          DTS:DTSID="{4F915A81-03C5-4580-B5A2-E5125C7466F8}"
          DTS:From="Package\Archivo C\Data Flow Task"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Restricción 1"
          DTS:To="Package\Archivo C\Correo Error"
          DTS:Value="1" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--Esta sección CDATA contiene la información de diseño del paquete. Esta sección incluye información como, por ejemplo, las coordenadas (x,y), el ancho y el alto.-->
<!--Si edita manualmente esta sección y comete un error, puede eliminarlo. -->
<!--El paquete podrá cargarse normalmente, pero se perderá la información de diseño anterior y el diseñador reorganizará los elementos automáticamente en la superficie de diseño.-->
<Objects
  Version="8">
  <!--Cada uno de los nodos siguientes contiene propiedades que no afectan al comportamiento en tiempo de ejecución.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="153,42"
          Id="Package\Archivo A\Correo Correcto"
          TopLeft="9,117.5" />
        <NodeLayout
          Size="137,42"
          Id="Package\Archivo A\Correo Error"
          TopLeft="183,119.5" />
        <NodeLayout
          Size="151,42"
          Id="Package\Archivo A\Data Flow Task"
          TopLeft="88.5,32" />
        <EdgeLayout
          Id="Package\Archivo A.PrecedenceConstraints[Restricción]"
          TopLeft="140.166666666667,74">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-54.6666666666667,43.5"
              Start="0,0"
              End="-54.6666666666667,36">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,13.6736566186107" />
                  <mssgle:CubicBezierSegment
                    Point1="0,13.6736566186107"
                    Point2="0,17.6736566186107"
                    Point3="-4,17.6736566186107" />
                  <mssgle:LineSegment
                    End="-50.6666666666667,17.6736566186107" />
                  <mssgle:CubicBezierSegment
                    Point1="-50.6666666666667,17.6736566186107"
                    Point2="-54.6666666666667,17.6736566186107"
                    Point3="-54.6666666666667,21.6736566186107" />
                  <mssgle:LineSegment
                    End="-54.6666666666667,36" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Archivo A.PrecedenceConstraints[Restricción 1]"
          TopLeft="187.833333333333,74">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="63.6666666666667,45.5"
              Start="0,0"
              End="63.6666666666667,38">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,14.4862385321101" />
                  <mssgle:CubicBezierSegment
                    Point1="0,14.4862385321101"
                    Point2="0,18.4862385321101"
                    Point3="4,18.4862385321101" />
                  <mssgle:LineSegment
                    End="59.6666666666667,18.4862385321101" />
                  <mssgle:CubicBezierSegment
                    Point1="59.6666666666667,18.4862385321101"
                    Point2="63.6666666666667,18.4862385321101"
                    Point3="63.6666666666667,22.4862385321101" />
                  <mssgle:LineSegment
                    End="63.6666666666667,38" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="20.3046419270833,23.4862385321101,23.0573828125,9.421875"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="330,216"
          Size="330,259"
          Id="Package\Archivo A"
          TopLeft="66,110.5" />
        <NodeLayout
          Size="153,42"
          Id="Package\Archivo B\Correo Correcto"
          TopLeft="14,105.5" />
        <NodeLayout
          Size="137,42"
          Id="Package\Archivo B\Correo Error"
          TopLeft="188,107.5" />
        <NodeLayout
          Size="151,42"
          Id="Package\Archivo B\Data Flow Task"
          TopLeft="92.5,23" />
        <EdgeLayout
          Id="Package\Archivo B.PrecedenceConstraints[Restricción]"
          TopLeft="168,65">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-77.5,40.5"
              Start="0,0"
              End="-77.5,33">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.25" />
                  <mssgle:CubicBezierSegment
                    Point1="0,16.25"
                    Point2="0,20.25"
                    Point3="-4,20.25" />
                  <mssgle:LineSegment
                    End="-73.5,20.25" />
                  <mssgle:CubicBezierSegment
                    Point1="-73.5,20.25"
                    Point2="-77.5,20.25"
                    Point3="-77.5,24.25" />
                  <mssgle:LineSegment
                    End="-77.5,33" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Archivo B.PrecedenceConstraints[Restricción 1]"
          TopLeft="191.833333333333,65">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="64.6666666666667,42.5"
              Start="0,0"
              End="64.6666666666667,35">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,13.2673656618611" />
                  <mssgle:CubicBezierSegment
                    Point1="0,13.2673656618611"
                    Point2="0,17.2673656618611"
                    Point3="4,17.2673656618611" />
                  <mssgle:LineSegment
                    End="60.6666666666667,17.2673656618611" />
                  <mssgle:CubicBezierSegment
                    Point1="60.6666666666667,17.2673656618611"
                    Point2="64.6666666666667,17.2673656618611"
                    Point3="64.6666666666667,21.2673656618611" />
                  <mssgle:LineSegment
                    End="64.6666666666667,35" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="330,205"
          Size="330,248"
          Id="Package\Archivo B"
          TopLeft="450,114.5" />
        <NodeLayout
          Size="153,42"
          Id="Package\Archivo C\Correo Correcto"
          TopLeft="6.5,119" />
        <NodeLayout
          Size="137,42"
          Id="Package\Archivo C\Correo Error"
          TopLeft="180.5,121" />
        <NodeLayout
          Size="151,42"
          Id="Package\Archivo C\Data Flow Task"
          TopLeft="94.5,22" />
        <EdgeLayout
          Id="Package\Archivo C.PrecedenceConstraints[Restricción]"
          TopLeft="146.166666666667,64">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-63.1666666666666,55"
              Start="0,0"
              End="-63.1666666666666,47.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,18.3460026212319" />
                  <mssgle:CubicBezierSegment
                    Point1="0,18.3460026212319"
                    Point2="0,22.3460026212319"
                    Point3="-4,22.3460026212319" />
                  <mssgle:LineSegment
                    End="-59.1666666666666,22.3460026212319" />
                  <mssgle:CubicBezierSegment
                    Point1="-59.1666666666666,22.3460026212319"
                    Point2="-63.1666666666666,22.3460026212319"
                    Point3="-63.1666666666666,26.3460026212319" />
                  <mssgle:LineSegment
                    End="-63.1666666666666,47.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Archivo C.PrecedenceConstraints[Restricción 1]"
          TopLeft="193.833333333333,64">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="55.1666666666667,57"
              Start="0,0"
              End="55.1666666666667,49.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.1585845347313" />
                  <mssgle:CubicBezierSegment
                    Point1="0,19.1585845347313"
                    Point2="0,23.1585845347313"
                    Point3="4,23.1585845347313" />
                  <mssgle:LineSegment
                    End="51.1666666666667,23.1585845347313" />
                  <mssgle:CubicBezierSegment
                    Point1="51.1666666666667,23.1585845347313"
                    Point2="55.1666666666667,23.1585845347313"
                    Point3="55.1666666666667,27.1585845347313" />
                  <mssgle:LineSegment
                    End="55.1666666666667,49.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="16.0546419270833,28.1585845347313,23.0573828125,9.421875"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="323,206"
          Size="323,249"
          Id="Package\Archivo C"
          TopLeft="829,115.5" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Archivo A\Data Flow Task">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="172,42"
          Id="Package\Archivo A\Data Flow Task\Flat File Destination"
          TopLeft="379,215" />
        <NodeLayout
          Size="172,42"
          Id="Package\Archivo A\Data Flow Task\Origen de ADO NET"
          TopLeft="379,44" />
        <EdgeLayout
          Id="Package\Archivo A\Data Flow Task.Paths[Salida de origen de ADO NET]"
          TopLeft="465,86">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,129"
              Start="0,0"
              End="0,121.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,121.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Archivo A\Data Flow Task\Origen de ADO NET">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Archivo B\Data Flow Task">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="172,42"
          Id="Package\Archivo B\Data Flow Task\Flat File Destination"
          TopLeft="377,254" />
        <NodeLayout
          Size="181,42"
          Id="Package\Archivo B\Data Flow Task\Ahorristias_Archivo_C"
          TopLeft="377,53" />
        <EdgeLayout
          Id="Package\Archivo B\Data Flow Task.Paths[Salida de origen de ADO NET]"
          TopLeft="465.25,95">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,159"
              Start="0,0"
              End="0,151.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,151.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <TaskHost
    design-time-name="Package\Archivo C\Data Flow Task">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="172,42"
          Id="Package\Archivo C\Data Flow Task\Flat File Destination"
          TopLeft="377,254" />
        <NodeLayout
          Size="181,42"
          Id="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C"
          TopLeft="377,53" />
        <EdgeLayout
          Id="Package\Archivo C\Data Flow Task.Paths[Salida de origen de ADO NET]"
          TopLeft="465.25,95">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,159"
              Start="0,0"
              End="0,151.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,151.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Archivo C\Data Flow Task\Ahorristias_Archivo_C">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>